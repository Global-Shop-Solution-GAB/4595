Program.Sub.ScreenSU.Start
Gui.FrmSOMain..Create
Gui.FrmSOMain..Caption("Sales Order Dashboard")
Gui.FrmSOMain..Size(15360,11520)
Gui.FrmSOMain..MinX(15360)
Gui.FrmSOMain..MinY(10695)
Gui.FrmSOMain..Position(0,0)
Gui.FrmSOMain..BackColor(-2147483633)
Gui.FrmSOMain..MousePointer(0)
Gui.FrmSOMain..Event(Resize,FrmSOMain_Resize)
Gui.FrmSOMain..Event(UnLoad,FrmSOMain_UnLoad)
Gui.FrmSOMain.tabSODash.Create(Tab)
Gui.FrmSOMain.tabSODash.Size(15120,9780)
Gui.FrmSOMain.tabSODash.Position(15,1125)
Gui.FrmSOMain.tabSODash.Event(Click,tabSODash_Click)
Gui.FrmSOMain.tabSODash.Tabs(3)
Gui.FrmSOMain.tabSODash.SetTab(0)
Gui.FrmSOMain.tabSODash.Caption("All Open SOs")
Gui.FrmSOMain.tabSODash.SetTab(1)
Gui.FrmSOMain.tabSODash.Caption("Due Today & Past Due")
Gui.FrmSOMain.tabSODash.SetTab(2)
Gui.FrmSOMain.tabSODash.Caption("Sales Statistics")
Gui.FrmSOMain.GsGCAllSO.Create(GsGridControl)
Gui.FrmSOMain.GsGCAllSO.Size(15000,9345)
Gui.FrmSOMain.GsGCAllSO.Position(0,0)
Gui.FrmSOMain.GsGCAllSO.Parent("tabSODash",0)
Gui.FrmSOMain.GsGCAllSO.Event(RowCellClick,GsGCAllSO_RowCellClick)
Gui.FrmSOMain.GsGCAllSO.Event(CellValueChanged,GsGCAllSO_CellValueChanged)
Gui.FrmSOMain.GsGCAllSO.Event(ColumnFilterChanged,GsGCAllSO_ColumnFilterChanged)
Gui.FrmSOMain.GsGCDueSO.Create(GsGridControl)
Gui.FrmSOMain.GsGCDueSO.Size(15000,9345)
Gui.FrmSOMain.GsGCDueSO.Position(0,0)
Gui.FrmSOMain.GsGCDueSO.Parent("tabSODash",1)
Gui.FrmSOMain.GsGCDueSO.Event(RowCellClick,GsGCDueSO_RowCellClick)
Gui.FrmSOMain.GsGCDueSO.Event(CellValueChanged,GsGCDueSO_CellValueChanged)
Gui.FrmSOMain.GsGCDueSO.Event(ColumnFilterChanged,GsGCDueSO_ColumnFilterChanged)
Gui.FrmSOMain.frameCustomer.Create(Frame)
Gui.FrmSOMain.frameCustomer.Size(12990,3945)
Gui.FrmSOMain.frameCustomer.Position(1005,240)
Gui.FrmSOMain.frameCustomer.Parent("tabSODash",2)
Gui.FrmSOMain.frameCustomer.Event(DblClick,frameCustomer_DblClick)
Gui.FrmSOMain.gsCustomer.Create(gsChart)
Gui.FrmSOMain.gsCustomer.Size(12990,3945)
Gui.FrmSOMain.gsCustomer.Position(0,0)
Gui.FrmSOMain.gsCustomer.Parent("frameCustomer")
Gui.FrmSOMain.gsCustomer.Enabled(False)
Gui.FrmSOMain.frameSalesPerson.Create(Frame)
Gui.FrmSOMain.frameSalesPerson.Size(7140,3945)
Gui.FrmSOMain.frameSalesPerson.Position(240,4440)
Gui.FrmSOMain.frameSalesPerson.Parent("tabSODash",2)
Gui.FrmSOMain.frameSalesPerson.Event(DblClick,frameSalesPerson_DblClick)
Gui.FrmSOMain.gsSalesPerson.Create(gsChart)
Gui.FrmSOMain.gsSalesPerson.Size(7140,3945)
Gui.FrmSOMain.gsSalesPerson.Position(0,0)
Gui.FrmSOMain.gsSalesPerson.Parent("frameSalesPerson")
Gui.FrmSOMain.gsSalesPerson.Enabled(False)
Gui.FrmSOMain.framePL.Create(Frame)
Gui.FrmSOMain.framePL.Size(7140,3945)
Gui.FrmSOMain.framePL.Position(7620,4440)
Gui.FrmSOMain.framePL.Parent("tabSODash",2)
Gui.FrmSOMain.framePL.Event(DblClick,framePL_DblClick)
Gui.FrmSOMain.gsPL.Create(gsChart)
Gui.FrmSOMain.gsPL.Size(7140,3945)
Gui.FrmSOMain.gsPL.Position(0,0)
Gui.FrmSOMain.gsPL.Parent("framePL")
Gui.FrmSOMain.gsPL.Enabled(False)
Gui.FrmSOMain.txtAllTotal.Create(TextBox,"",True,1560,300,0,10605,690,True,1,"Arial",8,-2147483643,1)
Gui.FrmSOMain.txtAllTotal.Locked(True)
Gui.FrmSOMain.lblAllTotal.Create(Label,"All Open SOs Total:",True,1635,255,0,10590,450,True,0,"Arial",8,-2147483633,0)
Gui.FrmSOMain.picGSSLogo.Create(PictureBox)
Gui.FrmSOMain.picGSSLogo.Size(4125,960)
Gui.FrmSOMain.picGSSLogo.Position(5520,45)
Gui.FrmSOMain.picGSSLogo.Event(DblClick,picGSSLogo_DblClick)
Gui.FrmSOMain.picGSSLogo.ToolTip("Double-Click for additional functions")
Gui.FrmSOMain.lblStatus.Create(Label,"***Change***",False,3750,255,0,75,120,True,0,"Arial",8,-986896,0)
Gui.FrmSOMain.pbStatus.Create(ProgressBar)
Gui.FrmSOMain.pbStatus.Size(3735,255)
Gui.FrmSOMain.pbStatus.Position(90,360)
Gui.FrmSOMain.pbStatus.Visible(False)
Gui.FrmSOMain.lblPastDueTotal.Create(Label,"Past Due SOs Total:",False,1635,255,0,10590,450,True,0,"Arial",8,-2147483633,0)
Gui.FrmSOMain.lblPastDueTotal.ForeColor(0)
Gui.FrmSOMain.txtPastDueTotal.Create(TextBox,"",False,1560,300,0,10605,690,True,1,"Arial",8,-2147483643,1)
Gui.FrmSOMain.txtPastDueTotal.ForeColor(0)
Gui.FrmSOMain.txtPastDueTotal.Locked(True)
Gui.FrmSOMain.txtChartTotal.Create(TextBox,"",False,1560,300,0,10605,690,True,1,"Arial",8,-2147483643,1)
Gui.FrmSOMain.txtChartTotal.ForeColor(0)
Gui.FrmSOMain.txtChartTotal.Locked(True)
Gui.FrmSOMain.framePermissions.Create(Frame)
Gui.FrmSOMain.framePermissions.Size(2760,420)
Gui.FrmSOMain.framePermissions.Position(12285,600)
Gui.FrmSOMain.optEdit.Create(Option)
Gui.FrmSOMain.optEdit.Enabled(False)
Gui.FrmSOMain.optEdit.Size(690,195)
Gui.FrmSOMain.optEdit.Position(1050,150)
Gui.FrmSOMain.optEdit.Caption("Edit")
Gui.FrmSOMain.optEdit.Parent("framePermissions")
Gui.FrmSOMain.optShip.Create(Option)
Gui.FrmSOMain.optShip.Enabled(False)
Gui.FrmSOMain.optShip.Size(795,255)
Gui.FrmSOMain.optShip.Position(1845,120)
Gui.FrmSOMain.optShip.Caption("Ship")
Gui.FrmSOMain.optShip.Parent("framePermissions")
Gui.FrmSOMain.optView.Create(Option)
Gui.FrmSOMain.optView.Size(690,195)
Gui.FrmSOMain.optView.Position(225,150)
Gui.FrmSOMain.optView.Caption("View")
Gui.FrmSOMain.optView.Parent("framePermissions")
Gui.FrmSOMain.frameButtons.Create(Frame)
Gui.FrmSOMain.frameButtons.Size(2760,600)
Gui.FrmSOMain.frameButtons.Position(12285,75)
Gui.FrmSOMain.cmdNew.Create(Button)
Gui.FrmSOMain.cmdNew.Size(840,375)
Gui.FrmSOMain.cmdNew.Position(1860,165)
Gui.FrmSOMain.cmdNew.Caption("New SO")
Gui.FrmSOMain.cmdNew.Event(Click,cmdNew_Click)
Gui.FrmSOMain.cmdNew.Enabled(False)
Gui.FrmSOMain.cmdNew.Parent("frameButtons")
Gui.FrmSOMain.cmdRefresh.Create(Button)
Gui.FrmSOMain.cmdRefresh.Size(840,375)
Gui.FrmSOMain.cmdRefresh.Position(60,165)
Gui.FrmSOMain.cmdRefresh.Caption("REFRESH")
Gui.FrmSOMain.cmdRefresh.Event(Click,cmdRefresh_Click)
Gui.FrmSOMain.cmdRefresh.Parent("frameButtons")
Gui.FrmSOMain.cmdExport.Create(Button)
Gui.FrmSOMain.cmdExport.Size(840,375)
Gui.FrmSOMain.cmdExport.Position(960,165)
Gui.FrmSOMain.cmdExport.Caption("Export")
Gui.FrmSOMain.cmdExport.Event(Click,cmdExport_Click)
Gui.FrmSOMain.cmdExport.Parent("frameButtons")
Gui.FrmSOMain.txtPercent.Create(TextBox,"",False,360,300,0,11505,105,True,0,"Arial",8,-2147483643,1)
Gui.FrmSOMain.txtPercent.MaxLength(2)
Gui.FrmSOMain.txtPercent.Event(LostFocus,txtPercent_LostFocus)
Gui.FrmSOMain.lblPercent2.Create(Label,"%",False,300,255,0,11925,165,True,0,"Arial",8,-2147483633,0)
Gui.FrmSOMain.lblPercent1.Create(Label,"Cutoff:",False,540,255,0,10935,165,True,0,"Arial",8,-2147483633,0)
Gui.FrmSOMain.lblCurr.Create(Label,V.Company.CurrencySymbol,True,510,255,0,10020,780,True,1,"Arial",8,-2147483633,0)
Gui.FrmCustomer..Create
Gui.FrmCustomer..Size(15360,10695)
Gui.FrmCustomer..MinX(0)
Gui.FrmCustomer..MinY(0)
Gui.FrmCustomer..Position(0,0)
Gui.FrmCustomer..BackColor(-2147483633)
Gui.FrmCustomer..MousePointer(0)
Gui.FrmCustomer..Event(UnLoad,FrmCustomer_UnLoad)
Gui.FrmCustomer..Caption("Customer Statistics")
Gui.FrmCustomer.GsGridControlCustomerStat.Create(GsGridControl)
Gui.FrmCustomer.GsGridControlCustomerStat.Size(3945,10215)
Gui.FrmCustomer.GsGridControlCustomerStat.Position(60,75)
Gui.FrmCustomer.gsCustomer.Create(gsChart)
Gui.FrmCustomer.gsCustomer.Size(11190,10215)
Gui.FrmCustomer.gsCustomer.Position(4020,75)
Gui.FrmPL..Create
Gui.FrmPL..Size(15360,10695)
Gui.FrmPL..MinX(0)
Gui.FrmPL..MinY(0)
Gui.FrmPL..Position(0,0)
Gui.FrmPL..BackColor(-2147483633)
Gui.FrmPL..MousePointer(0)
Gui.FrmPL..Caption("Product Line Statistics")
Gui.FrmPL..Event(UnLoad,FrmPL_UnLoad)
Gui.FrmPL.GsGridControlPLStat.Create(GsGridControl)
Gui.FrmPL.GsGridControlPLStat.Size(3870,10215)
Gui.FrmPL.GsGridControlPLStat.Position(60,75)
Gui.FrmPL.gsPL.Create(gsChart)
Gui.FrmPL.gsPL.Size(11265,10215)
Gui.FrmPL.gsPL.Position(3945,75)
Gui.FrmSalesPerson..Create
Gui.FrmSalesPerson..Size(15360,10695)
Gui.FrmSalesPerson..MinX(0)
Gui.FrmSalesPerson..MinY(0)
Gui.FrmSalesPerson..Position(0,0)
Gui.FrmSalesPerson..BackColor(-2147483633)
Gui.FrmSalesPerson..MousePointer(0)
Gui.FrmSalesPerson..Event(UnLoad,FrmSalesPerson_UnLoad)
Gui.FrmSalesPerson..Caption("Salesperson Statistics")
Gui.FrmSalesPerson.GsGridControlSalesPersonStat.Create(GsGridControl)
Gui.FrmSalesPerson.GsGridControlSalesPersonStat.Size(3870,10215)
Gui.FrmSalesPerson.GsGridControlSalesPersonStat.Position(60,75)
Gui.FrmSalesPerson.gsSalesPerson.Create(gsChart)
Gui.FrmSalesPerson.gsSalesPerson.Size(11265,10215)
Gui.FrmSalesPerson.gsSalesPerson.Position(3945,75)
Gui.frmWeb..Create
Gui.frmWeb..Caption("Global Shop Solutions - Web Sites")
Gui.frmWeb..Size(3990,2025)
Gui.frmWeb..MinX(0)
Gui.frmWeb..MinY(0)
Gui.frmWeb..Position(0,0)
Gui.frmWeb..BackColor(-2147483633)
Gui.frmWeb..MousePointer(0)
Gui.frmWeb..MaxButton(False)
Gui.frmWeb..Sizeable(False)
Gui.frmWeb..Event(UnLoad,frmWeb_UnLoad)
Gui.frmWeb..MinButton(False)
Gui.frmWeb.cmdGSS.Create(Button)
Gui.frmWeb.cmdGSS.Size(3615,375)
Gui.frmWeb.cmdGSS.Position(120,45)
Gui.frmWeb.cmdGSS.Caption("Global Shop Solutions")
Gui.frmWeb.cmdGSS.Event(Click,cmdGSS_Click)
Gui.frmWeb.cmdServ.Create(Button)
Gui.frmWeb.cmdServ.Size(3615,375)
Gui.frmWeb.cmdServ.Position(120,450)
Gui.frmWeb.cmdServ.Caption("ServiceWeb")
Gui.frmWeb.cmdServ.Event(Click,cmdServ_Click)
Gui.frmWeb.cmdUpd.Create(Button)
Gui.frmWeb.cmdUpd.Size(3615,375)
Gui.frmWeb.cmdUpd.Position(120,855)
Gui.frmWeb.cmdUpd.Caption("GSS Updates")
Gui.frmWeb.cmdUpd.Event(Click,cmdUpd_Click)
Gui.frmWeb.cmdResetGsGC.Create(Button)
Gui.frmWeb.cmdResetGsGC.Size(3615,375)
Gui.frmWeb.cmdResetGsGC.Position(120,1260)
Gui.frmWeb.cmdResetGsGC.Caption("Reset All Columns")
Gui.frmWeb.cmdResetGsGC.Event(Click,cmdResetGsGC_Click)
Gui.frmNotes..Create
Gui.frmNotes..Caption("Notes: Order-Line")
Gui.frmNotes..Size(14460,7425)
Gui.frmNotes..MinX(0)
Gui.frmNotes..MinY(0)
Gui.frmNotes..Position(0,0)
Gui.frmNotes..BackColor(-2147483633)
Gui.frmNotes..MousePointer(0)
Gui.frmNotes..Event(UnLoad,frmNotes_UnLoad)
Gui.frmNotes.GsGCNotes.Create(GsGridControl)
Gui.frmNotes.GsGCNotes.Size(14310,7125)
Gui.frmNotes.GsGCNotes.Position(0,0)
Gui.frmNotes.GsGCNotes.Event(RowCellClick,GsGCNotes_RowCellClick)
Gui.frmNotes.GsGCNotes.Event(CellValueChanged,GsGCNotes_CellValueChanged)
Gui.frmEmail..Create
Gui.frmEmail..Caption("Email")
Gui.frmEmail..Size(6090,5670)
Gui.frmEmail..MinX(0)
Gui.frmEmail..MinY(0)
Gui.frmEmail..Position(0,0)
Gui.frmEmail..BackColor(-2147483633)
Gui.frmEmail..MousePointer(0)
Gui.frmEmail..Event(UnLoad,frmEmail_UnLoad)
Gui.frmEmail..MaxButton(False)
Gui.frmEmail..MinButton(False)
Gui.frmEmail..Sizeable(False)
Gui.frmEmail.lblRcpts.Create(Label,"Recipients (Separate multiple contacts by using commas)",True,5550,255,0,105,150,True,0,"Arial",8,-2147483633,0)
Gui.frmEmail.txtRcpts.Create(TextboxM)
Gui.frmEmail.txtRcpts.Size(5835,855)
Gui.frmEmail.txtRcpts.Position(105,360)
Gui.frmEmail.lblSubject.Create(Label,"Subject",True,1935,255,0,105,1305,True,0,"Arial",8,-2147483633,0)
Gui.frmEmail.txtSubject.Create(TextBox,"",True,5835,300,0,105,1515,True,0,"Arial",8,-2147483643,1)
Gui.frmEmail.lblBody.Create(Label,"Body",True,1935,255,0,105,1905,True,0,"Arial",8,-2147483633,0)
Gui.frmEmail.txtBody.Create(TextboxM)
Gui.frmEmail.txtBody.Size(5835,2715)
Gui.frmEmail.txtBody.Position(105,2115)
Gui.frmEmail.cmdSend.Create(Button)
Gui.frmEmail.cmdSend.Size(855,375)
Gui.frmEmail.cmdSend.Position(105,4905)
Gui.frmEmail.cmdSend.Caption("Send")
Gui.frmEmail.cmdSend.Event(Click,cmdSend_Click)
Gui.frmEmail.lblInfo.Create(Label,"*Emails will be sent through Courier",True,2625,255,0,3315,5085,True,0,"Arial",7,-2147483633,0)
Gui.frmText..Create
Gui.frmText..Caption("Text Message")
Gui.frmText..Size(6090,5670)
Gui.frmText..MinX(0)
Gui.frmText..MinY(0)
Gui.frmText..Position(0,0)
Gui.frmText..BackColor(-2147483633)
Gui.frmText..MousePointer(0)
Gui.frmText..Event(UnLoad,frmText_UnLoad)
Gui.frmText..MaxButton(False)
Gui.frmText..MinButton(False)
Gui.frmText..Sizeable(False)
Gui.frmText.lblRcpts.Create(Label,"Recipients ###-###-#### (Separate multiple contacts by using commas)",True,5550,255,0,105,150,True,0,"Arial",8,-2147483633,0)
Gui.frmText.txtRcpts.Create(TextboxM)
Gui.frmText.txtRcpts.Size(5835,855)
Gui.frmText.txtRcpts.Position(105,360)
Gui.frmText.lblSubject.Create(Label,"Subject",True,1935,255,0,105,1305,True,0,"Arial",8,-2147483633,0)
Gui.frmText.txtSubject.Create(TextBox,"",True,5835,300,0,105,1515,True,0,"Arial",8,-2147483643,1)
Gui.frmText.lblBody.Create(Label,"Body",True,1935,255,0,105,1905,True,0,"Arial",8,-2147483633,0)
Gui.frmText.txtBody.Create(TextboxM)
Gui.frmText.txtBody.Size(5835,2715)
Gui.frmText.txtBody.Position(105,2115)
Gui.frmText.cmdSend.Create(Button)
Gui.frmText.cmdSend.Size(855,375)
Gui.frmText.cmdSend.Position(105,4905)
Gui.frmText.cmdSend.Caption("Send")
Gui.frmText.cmdSend.Event(Click,cmdSendText_Click)
Gui.frmText.lblInfo.Create(Label,"*Text Messages will be sent through Courier",True,3255,255,0,2685,5085,True,0,"Arial",7,-2147483633,0)
Gui.frmText.ddl1.Create(DropDownList)
Gui.frmText.ddl1.Size(1590,330)
Gui.frmText.ddl1.Position(1005,4920)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
	v.Global.fOrderTot.Declare
	V.Global.iPercent.Declare
	V.Global.sUserEmail.Declare
	V.Global.sOrderNo.Declare
	V.Global.sOrderLn.Declare
	V.Global.sCustomer.Declare
	V.Global.sSalesperson.Declare
	V.Global.sPart.Declare
	V.Global.sPaerDesc.Declare
	V.Global.fQty.Declare
	V.Global.sCustPO.Declare
	V.Global.dDueDate.Declare
	V.Global.bLoadData.Declare
Program.Sub.Preflight.End

Program.Sub.Main.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sIcon.Declare
	V.Local.sGssLogo.Declare

	F.Intrinsic.String.Build("{0}\GAB\GAS\gss2.ico",V.Caller.PluginsDir,v.Local.sIcon)
	F.Intrinsic.String.Build("{0}\GAB\GAS\GAB_GSS_Logo_Green_Dash.png",V.Caller.PluginsDir,V.Local.sGssLogo)
	Gui.frmWeb..Icon(V.Local.sIcon)
	Gui.FrmSOMain.picGSSLogo.Picture(V.Local.sGssLogo)
	Gui.FrmSOMain..Icon(V.Local.sIcon)
	Gui.FrmCustomer..Icon(V.Local.sIcon)
	Gui.FrmPL..Icon(V.Local.sIcon)
	Gui.FrmSalesPerson..Icon(V.Local.sIcon)

	Gui.FrmSOMain.optEdit.Value(False)
	Gui.FrmSOMain.optView.Value(True)
	Gui.FrmSOMain.optShip.Value(False)
	Gui.FrmSOMain.tabSODash.SetTab(0)

	F.Intrinsic.Control.CallSub(SetAnchors)
	F.Intrinsic.Control.CallSub(checkpermissions)
	F.Intrinsic.Control.CallSub(SetContextMenus)
	F.Intrinsic.Control.CallSub(SetCarriers)
	
	F.Global.Security.GetUserEmail(V.Caller.User,V.Caller.CompanyCode,V.Global.sUserEmail)

	F.ODBC.Connection!con.OpenConnection(V.Ambient.PDSN,V.Ambient.PUser,V.Ambient.PPass,600)

	'Check and populate percentage from GS_Registry
	F.Global.Registry.ReadValue("SUPERVSR",V.Caller.CompanyCode,"4595",4595,1000,1,"",V.Global.iPercent)
	F.Intrinsic.Control.If(V.Global.iPercent,=,0)
		F.Global.Registry.AddValue("SUPERVSR",V.Caller.CompanyCode,"4595",4595,1000,"False","Top Percent",False,3,-999.0,1/1/1980,12:00:00 AM)
		V.Global.iPercent.Set(3)
	F.Intrinsic.Control.EndIf
	Gui.FrmSOMain.txtPercent.Text(V.Global.iPercent)

	Gui.FrmSOMain..Show
	F.Intrinsic.Control.CallSub(SetTabAnchors)
	F.Intrinsic.Control.CallSub(checktable)
	F.Intrinsic.Control.CallSub(disablecontrols)
	F.Intrinsic.Control.CallSub(charts2)
	Gui.FrmSOMain.lblStatus.Caption("Loading Sales Orders....")
	Gui.FrmSOMain.pbStatus.Min(0)
	Gui.FrmSOMain.pbStatus.Max(100)
	Gui.FrmSOMain.pbStatus.Value(15)
	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.CallSub(loaddtallso)
	F.Intrinsic.Control.CallSub(loaddtdueso)
	F.Intrinsic.Control.CallSub(OrderTotal,"Load","FirstLoad","Filter","ORDER_NO LIKE '%%'")
	F.Intrinsic.Control.UnBlockEvents
	Gui.FrmSOMain.pbStatus.Value(90)
	Gui.FrmSOMain.pbStatus.Value(100)
	F.Intrinsic.Control.CallSub(enablecontrols)
	F.Intrinsic.Control.CallSub(Deserialize)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.Main.End

Program.Sub.FrmSOMain_Resize.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	v.Local.iWidth.Declare
	V.Local.iHeight.Declare
	V.Local.iX.Declare
	v.Local.y.Declare(float)
	v.Local.iXcoord.Declare
	v.Local.size.Declare
	v.Local.iycoord.Declare

	f.Intrinsic.Math.sub(v.Screen.FrmSOMain!tabSODash.Width,2130,v.Local.iWidth)
	f.Intrinsic.Math.Sub(v.Screen.FrmSOMain!tabSODash.Height,5070,v.Local.iHeight)
	Gui.FrmSOMain.frameCustomer.Size(v.Local.iWidth,v.Local.iHeight)
	Gui.FrmSOMain.gsCustomer.Size(v.Local.iWidth,v.Local.iHeight)

	f.Intrinsic.Math.Add(v.Screen.FrmSOMain!frameCustomer.Height,495,v.Local.iycoord)
	f.Intrinsic.Math.Add(v.Screen.FrmSOMain!frameCustomer.Width,2010,v.Local.size)
	f.Intrinsic.Math.Mult(v.local.size,.5,v.Local.iXCoord)
	f.Intrinsic.Math.Add(v.Local.ixCoord,120,v.Local.ixcoord)
	Gui.FrmSOMain.framePL.Position(v.Local.iXcoord,v.Local.iycoord)
	Gui.FrmSOMain.frameSalesPerson.Position(240,v.Local.iycoord)

	f.Intrinsic.Math.mult(v.Screen.FrmSOMain!tabSODash.Width,.47222222222,v.local.iWidth)
	f.Intrinsic.Math.Mult(v.Screen.FrmSOMain!tabSODash.Height,.43760399334,v.Local.iHeight)
	Gui.FrmSOMain.framePL.Size(v.Local.iWidth,3945)
	Gui.FrmSOMain.gsPL.Size(v.Local.iWidth,3945)
	Gui.FrmSOMain.frameSalesPerson.Size(v.Local.iWidth,3945)
	Gui.FrmSOMain.gsSalesPerson.size(v.Local.iWidth,3945)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.FrmSOMain_Resize.End

Program.Sub.FrmSOMain_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.If(V.Global.bLoadData)
		F.Intrinsic.Control.CallSub(Serialize)
	F.Intrinsic.Control.EndIf

	F.ODBC.Connection!con.Close
	F.Intrinsic.Control.End 
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.FrmSOMain_UnLoad.End

Program.Sub.cmdRefresh_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.If(V.Global.bLoadData)
		F.Intrinsic.Control.CallSub(Serialize)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.CallSub(disablecontrols)
	F.Intrinsic.Control.CallSub(charts2)
	Gui.FrmSOMain.pbStatus.Min(0)
	Gui.FrmSOMain.pbStatus.Max(100)
	Gui.FrmSOMain.pbStatus.Value(15)
	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.CallSub(loaddtallso)
	F.Intrinsic.Control.CallSub(loaddtdueso)
	F.Intrinsic.Control.CallSub(OrderTotal,"Load","FirstLoad","Filter","ORDER_NO LIKE '%%'")
	F.Intrinsic.Control.UnBlockEvents
	Gui.FrmSOMain.pbStatus.Value(100)
	F.Intrinsic.Control.CallSub(enablecontrols)
	F.Intrinsic.Control.CallSub(Deserialize)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.cmdRefresh_Click.End

Program.Sub.setAnchors.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	'0 - None
	'1 - Top
	'2 - Bottom
	'4 - Left
	'8 - Right

	Gui.FrmSOMain.picGSSLogo.Anchor(1)
	Gui.FrmSOMain.cmdNew.Anchor(5)
	Gui.FrmSOMain.tabSODash.Anchor(15)
	Gui.FrmSOMain.frameButtons.Anchor(9)
	Gui.FrmSOMain.framePermissions.Anchor(9)
	gui.FrmSOMain.lblAllTotal.Anchor(9)
	gui.FrmSOMain.txtAllTotal.Anchor(9)
	gui.FrmSOMain.lblPastDueTotal.Anchor(9)
	gui.FrmSOMain.txtPastDueTotal.Anchor(9)
	gui.FrmSOMain.txtChartTotal.Anchor(9)
	Gui.FrmSOMain.lblStatus.Anchor(5)
	Gui.FrmSOMain.pbStatus.Anchor(5)
	Gui.FrmSOMain.lblPercent1.Anchor(9)
	Gui.FrmSOMain.lblPercent2.Anchor(9)
	Gui.FrmSOMain.txtPercent.Anchor(9)
	Gui.FrmSOMain.lblCurr.Anchor(9)

	Gui.FrmCustomer.gsCustomer.Anchor(15)
	Gui.FrmCustomer.GsGridControlCustomerStat.Anchor(7)

	Gui.FrmPL.gsPL.Anchor(15)
	Gui.FrmPL.GsGridControlPLStat.Anchor(7)

	Gui.FrmSalesPerson.gsSalesperson.Anchor(15)
	Gui.FrmSalesPerson.GsGridControlSalesPersonStat.Anchor(7)
	
	Gui.frmNotes.GsGCNotes.Anchor(15)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.setAnchors.End

Program.Sub.SetTabAnchors.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	'0 - None
	'1 - Top
	'2 - Bottom
	'4 - Left
	'8 - Right

	Gui.FrmSOMain.GsGCAllSO.Anchor(15)
	Gui.FrmSOMain.GsGCDueSO.Anchor(15)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.SetTabAnchors.End

Program.Sub.loadDTAllSO.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	v.Local.sSQL.Declare

	Gui.FrmSOMain.lblStatus.Caption("Loading Sales Orders....")

	'Create Data Table
	F.Intrinsic.Control.If(V.DataTable.dtAllSO.Exists)
		F.data.datatable.close("dtAllSO")
		Gui.FrmSOMain.GsGCAllSO.ClearGrouping("gvAllSO")
	F.Intrinsic.Control.EndIf
	
	V.Global.bLoadData.Set(True)

	'Building the SQL Statement
	V.Local.SSQL.Set("Select DISTINCT A.Customer,E.Name_Customer,B.Description,B.Part,B.Location,A.Customer_PO,A.Order_NO,LEFT(B.Record_NO,3) AS Record_NO,CASE WHEN B.FLAG_USE_MQD != 'Y' THEN B.MUST_DLVR_BY_DATE WHEN FLAG_USE_MQD = 'Y' THEN C.CUST_DUE_DATE END AS MUST_DLVR_BY_DATE,CASE WHEN B.FLAG_USE_MQD != 'Y' THEN B.DATE_ITEM_PROM WHEN FLAG_USE_MQD = 'Y' THEN IF(C.DATE_DUE = '1900-01-01',CONVERT('9999-12-31',SQL_DATE),C.DATE_DUE) END AS ITEM_PROMISE_DT,CASE WHEN B.FLAG_USE_MQD != 'Y' THEN CAST(B.QTY_BO AS FLOAT) WHEN FLAG_USE_MQD = 'Y' THEN CAST(C.QTY_OPEN AS FLOAT) END AS QTY_BO,B.Discount_Price AS Price,CASE WHEN B.FLAG_USE_MQD != 'Y' THEN (B.QTY_BO*B.Discount_Price) WHEN FLAG_USE_MQD = 'Y' THEN (C.QTY_OPEN*B.Discount_Price) WHEN B.Discount_Price = 0 THEN 0.00 END AS BO_EXTENSION,CASE WHEN B.FLAG_USE_MQD != 'Y' THEN DATEDIFF(Day,B.DATE_ITEM_PROM,Now()) WHEN FLAG_USE_MQD = 'Y' THEN DATEDIFF(Day,C.DATE_DUE,Now()) END AS DateDiff,A.SalesPerson,B.Product_Line,CASE WHEN B.FLAG_USE_MQD = 'Y' THEN CONVERT(1,SQL_BIT) ELSE CONVERT(0,SQL_BIT) END AS FLAG_USE_MQD,'Notes' As NOTES,'' As LASTNOTE,B.USER_4,B.USER_5,B.QTY_ORIGINAL,B.EXTENSION,B.CUSTOMER_PART,Cast(Concat(B.Order_No,B.Record_No) as CHAR(10)) As ORDREC FROM V_ORDER_HEADER A LEFT JOIN V_ORDER_LINES B ON A.Order_NO = B.Order_NO LEFT JOIN V_OE_SHIP_SCHED C ON C.ORDER_NO = B.ORDER_NO AND C.ORDER_LINE = B.RECORD_NO LEFT JOIN V_ORDER_BILL_TO E ON E.ORDER_NO = B.ORDER_NO WHERE QTY_BO <> 0 AND LINE_TYPE <> 'F' and LINE_TYPE <> 'P' ORDER BY ITEM_PROMISE_DT;")
	F.Data.DataTable.CreateFromSQL("dtAllSO","con",v.Local.sSQL,True)
	
	F.Data.Dictionary.CreateFromSQL("dNotes","con","Select Cast(Concat(ORDER_NO,ORDER_LINE) as CHAR(10)) As ORDREC,RTrim(Notes) as Notes From GAB_4595_NOTES ORDER BY CREATE_DT DESC,CREATE_TIME DESC;")
	F.Data.Dictionary.SetDefaultReturn("dNotes","")
	F.Data.DataTable.FillFromDictionary("dtAllSO","dNotes","ORDREC","LASTNOTE")
	F.Data.Dictionary.Close("dNotes")

	Gui.FrmSOMain.pbStatus.Value(30)
	F.Intrinsic.Control.CallSub(loaddvgvallso)
	Gui.FrmSOMain.pbStatus.Value(45)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.loadDTAllSO.End

Program.Sub.loadDTDueSO.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	v.Local.sSQL.Declare
	V.Local.sFilter.Declare

	'Create Data Table
	F.Intrinsic.Control.If(V.DataTable.dtdueSO.Exists)
		F.data.datatable.close("dtdueSO")
		Gui.FrmSOMain.GsGCDueSO.ClearGrouping("gvDueSO")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.String.Build("ITEM_PROMISE_DT <= #{0}#",V.Ambient.Date.FormatMM/DD/YYYY,V.Local.sFilter)
	F.Data.DataView.Create("dtAllSO","dvDueSO",22,V.Local.sFilter,"")
	F.Data.DataView.ToDataTable("dtAllSO","dvDueSO","dtDueSO",True)

	Gui.FrmSOMain.pbStatus.Value(60)
	F.Intrinsic.Control.CallSub(loaddvgvdueSO)
	Gui.FrmSOMain.pbStatus.Value(75)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.loadDTDueSO.End

Program.Sub.loadDVGVAllSO.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sCaption.Declare

	Gui.FrmSOMain.GsGCAllSO.AddGridViewFromDataTable("gvAllSO","dtAllSO")
	Gui.frmSOMain.GsGCAllSO.MainView("gvAllSO")
	Gui.frmSOMain.GsGCAllSO.SuspendLayout()
	Gui.frmSOMain.GsGCAllSO.SetGridViewProperty("gvAllSO","MultiSelect",True)
	Gui.frmSOMain.GsGCAllSO.SetGridViewProperty("gvAllSO","AllowSort",True)
	Gui.frmSOMain.GsGCAllSO.SetGridViewProperty("gvAllSO","AllowFilter",True)
	Gui.frmSOMain.GsGCAllSO.SetGridViewProperty("gvAllSO","OptionsDetailShowDetailTabs",False)
	Gui.frmSOMain.GsGCAllSO.SetGridViewProperty("gvAllSO","OptionsViewShowGroupPanel",True)
	Gui.frmSOMain.GsGCAllSO.SetGridViewProperty("gvAllSO","EnableAppearanceOddRow",True)
	Gui.frmSOMain.GsGCAllSO.SetGridViewProperty("gvAllSO","OptionsMenuShowAutoFilterRowItem",False)

	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","NOTES","ShowCaption",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","ORDREC","Visible",False)

	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","NOTES","ReadOnly",True)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","NOTES","AllowEdit",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","LASTNOTE","ReadOnly",True)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","LASTNOTE","AllowEdit",True)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","USER_4","ReadOnly",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","USER_4","AllowEdit",True)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","USER_5","ReadOnly",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","USER_5","AllowEdit",True)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Customer","AllowEdit",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Name_Customer","AllowEdit",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Description","AllowEdit",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Part","AllowEdit",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Location","AllowEdit",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Product_Line","AllowEdit",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Customer_PO","AllowEdit",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Order_NO","AllowEdit",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Record_NO","AllowEdit",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Item_Promise_Dt","AllowEdit",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","MUST_DLVR_BY_DATE","AllowEdit",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Qty_BO","AllowEdit",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","PRICE","AllowEdit",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","FLAG_USE_MQD","AllowEdit",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","BO_EXTENSION","AllowEdit",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","DateDiff","AllowEdit",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","SalesPerson","AllowEdit",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","BO_EXTENSION","AllowEdit",False)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","PRICE","AllowEdit",False)

	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Customer","Caption","Cust No")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Name_Customer","Caption","Customer Name")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Description","Caption","Part Description")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Part","Caption","Part Number")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Location","Caption","Loc")	
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Product_Line","Caption","PL")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Customer_PO","Caption","Cust PO")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Order_NO","Caption","Order #")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Record_NO","Caption","Ln")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Item_Promise_Dt","Caption","Ship Date")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","MUST_DLVR_BY_DATE","Caption","Cust Due Dt")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Qty_BO","Caption","B/O Qty")
	F.Intrinsic.String.Build("Unit Price ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","PRICE","Caption",V.Local.sCaption)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","FLAG_USE_MQD","Caption","Ship Sched")
	F.Intrinsic.String.Build("Extension ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","BO_EXTENSION","Caption",V.Local.sCaption)
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","DateDiff","Caption","Days Past")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","NOTES","Caption","Notes")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","LASTNOTE","Caption","Last Note")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","USER_4","Caption","User Field 4 (30 Characters)")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","USER_5","Caption","User Field 5 (30 Characters)")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","SalesPerson","Caption","S/P")

	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","ORDER_NO","CELLFORECOLOR","BLUE")

	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","PRICE","CellHAlignment","FAR")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","BO_EXTENSION","CellHAlignment","FAR")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","ORDER_NO","CellHAlignment","Center")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","PRODUCT_LINE","CellHAlignment","Center")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","MUST_DLVR_BY_DATE","CellHAlignment","Center")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Item_Promise_Dt","CellHAlignment","Center")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","SalesPerson","CellHAlignment","Center")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","DateDiff","CellHAlignment","Center")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","FLAG_USE_MQD","CellHAlignment","Center")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","RECORD_NO","CellHAlignment","Center")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","NOTES","CellHAlignment","Center")

	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","ORDER_NO","HeaderHAlignment","Center")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","RECORD_NO","HeaderHAlignment","Center")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","PRODUCT_LINE","HeaderHAlignment","Center")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","DateDiff","HeaderHAlignment","Center")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","MUST_DLVR_BY_DATE","HeaderHAlignment","Center")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Item_Promise_Dt","HeaderHAlignment","Center")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","SalesPerson","HeaderHAlignment","Center")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","FLAG_USE_MQD","HeaderHAlignment","Center")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","NOTES","HeaderHAlignment","Center")

	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Customer","MinWidth","80")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Name_Customer","MinWidth","200")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Description","MinWidth","200")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Part","MinWidth","170")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Location","MinWidth","35")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Product_Line","MinWidth","35")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Customer_PO","MinWidth","170")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Order_NO","MinWidth","65")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Record_NO","MinWidth","35")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Item_Promise_Dt","MinWidth","100")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","MUST_DLVR_BY_DATE","MinWidth","100")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Qty_BO","MinWidth","80")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","PRICE","MinWidth","100")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","FLAG_USE_MQD","MinWidth","80")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","BO_EXTENSION","MinWidth","100")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","DateDiff","MinWidth","60")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","NOTES","MinWidth","60")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","LASTNOTE","MinWidth","200")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","USER_4","MinWidth","200")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","USER_5","MinWidth","200")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","SalesPerson","MinWidth","50")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","PRICE","MinWidth","100")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","BO_EXTENSION","MinWidth","100")

	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Customer","Fixed","Left")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Name_Customer","Fixed","Left")

	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","USER_4","CellBackColor","LightYellow")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","USER_5","CellBackColor","LightYellow")
	
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","NOTES","CellBackColor","Gray")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","NOTES","CellForeColor","White")

	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Qty_BO","DisplayCustomNumeric","#,###,##0.00")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","PRICE","DisplayCustomNumeric","#,###,##0.00")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","BO_EXTENSION","DisplayCustomNumeric","#,###,##0.00")

	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","Item_Promise_Dt","DisplayCustomDatetime","d")
	Gui.FrmSOMain.GsGCAllSO.SetColumnProperty("gvAllSO","MUST_DLVR_BY_DATE","DisplayCustomDatetime","d")

	Gui.frmSOMain.GsGCAllSO.ResumeLayout()
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.loadDVGVAllSO.End

Program.Sub.loadDVGVDueSO.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.sCaption.Declare

	Gui.FrmSOMain.GsGCDueSO.AddGridViewFromDataTable("gvDueSO","dtDueSO")
	Gui.frmSOMain.GsGCDueSO.MainView("gvDueSO")
	Gui.frmSOMain.GsGCDueSO.SuspendLayout()
	Gui.frmSOMain.GsGCDueSO.SetGridViewProperty("gvDueSO","MultiSelect",True)
	Gui.frmSOMain.GsGCDueSO.SetGridViewProperty("gvDueSO","AllowSort",True)
	Gui.frmSOMain.GsGCDueSO.SetGridViewProperty("gvDueSO","AllowFilter",True)
	Gui.frmSOMain.GsGCDueSO.SetGridViewProperty("gvDueSO","OptionsDetailShowDetailTabs",False)
	Gui.frmSOMain.GsGCDueSO.SetGridViewProperty("gvDueSO","OptionsViewShowGroupPanel",True)
	Gui.frmSOMain.GsGCDueSO.SetGridViewProperty("gvDueSO","EnableAppearanceOddRow",True)
	Gui.frmSOMain.GsGCDueSO.SetGridViewProperty("gvDueSO","OptionsMenuShowAutoFilterRowItem",False)

	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","NOTES","ShowCaption",False)

	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","NOTES","ReadOnly",True)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","NOTES","AllowEdit",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","LASTNOTE","ReadOnly",True)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","LASTNOTE","AllowEdit",True)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","USER_4","ReadOnly",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","USER_4","AllowEdit",True)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","USER_5","ReadOnly",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","USER_5","AllowEdit",True)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Customer","AllowEdit",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Name_Customer","AllowEdit",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Description","AllowEdit",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Part","AllowEdit",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Location","AllowEdit",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Product_Line","AllowEdit",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Customer_PO","AllowEdit",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Order_NO","AllowEdit",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Record_NO","AllowEdit",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Item_Promise_Dt","AllowEdit",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","MUST_DLVR_BY_DATE","AllowEdit",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Qty_BO","AllowEdit",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","PRICE","AllowEdit",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","FLAG_USE_MQD","AllowEdit",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","BO_EXTENSION","AllowEdit",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","DateDiff","AllowEdit",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","SalesPerson","AllowEdit",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","BO_EXTENSION","AllowEdit",False)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","PRICE","AllowEdit",False)

	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Customer","Caption","Cust No")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Name_Customer","Caption","Customer Name")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Description","Caption","Part Description")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Part","Caption","Part Number")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Location","Caption","Loc")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Product_Line","Caption","PL")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Customer_PO","Caption","Cust PO")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Order_NO","Caption","Order #")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Record_NO","Caption","Ln")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Item_Promise_Dt","Caption","Ship Date")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","MUST_DLVR_BY_DATE","Caption","Cust Due Dt")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Qty_BO","Caption","B/O Qty")
	F.Intrinsic.String.Build("Unit Price ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","PRICE","Caption",V.Local.sCaption)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","FLAG_USE_MQD","Caption","Ship Sched")
	F.Intrinsic.String.Build("Extension ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","BO_EXTENSION","Caption",V.Local.sCaption)
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","DateDiff","Caption","Days Past")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","NOTES","Caption","Notes")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","LASTNOTE","Caption","Last Note")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","USER_4","Caption","User Field 4 (30 Characters)")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","USER_5","Caption","User Field 5 (30 Characters)")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","SalesPerson","Caption","S/P")

	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","ORDER_NO","CELLFORECOLOR","BLUE")

	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","PRICE","CellHAlignment","FAR")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","BO_EXTENSION","CellHAlignment","FAR")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","ORDER_NO","CellHAlignment","Center")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","PRODUCT_LINE","CellHAlignment","Center")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","MUST_DLVR_BY_DATE","CellHAlignment","Center")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Item_Promise_Dt","CellHAlignment","Center")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","SalesPerson","CellHAlignment","Center")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","DateDiff","CellHAlignment","Center")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","FLAG_USE_MQD","CellHAlignment","Center")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","RECORD_NO","CellHAlignment","Center")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","NOTES","CellHAlignment","Center")

	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","ORDER_NO","HeaderHAlignment","Center")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","RECORD_NO","HeaderHAlignment","Center")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","PRODUCT_LINE","HeaderHAlignment","Center")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","DateDiff","HeaderHAlignment","Center")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","MUST_DLVR_BY_DATE","HeaderHAlignment","Center")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Item_Promise_Dt","HeaderHAlignment","Center")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","SalesPerson","HeaderHAlignment","Center")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","FLAG_USE_MQD","HeaderHAlignment","Center")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","NOTES","HeaderHAlignment","Center")

	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Customer","MinWidth","80")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Name_Customer","MinWidth","200")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Description","MinWidth","200")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Part","MinWidth","170")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Location","MinWidth","35")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Product_Line","MinWidth","35")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Customer_PO","MinWidth","170")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Order_NO","MinWidth","65")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Record_NO","MinWidth","35")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Item_Promise_Dt","MinWidth","100")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","MUST_DLVR_BY_DATE","MinWidth","100")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Qty_BO","MinWidth","80")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","PRICE","MinWidth","100")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","FLAG_USE_MQD","MinWidth","80")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","BO_EXTENSION","MinWidth","100")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","DateDiff","MinWidth","60")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","NOTES","MinWidth","60")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","LASTNOTE","MinWidth","200")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","USER_4","MinWidth","200")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","USER_5","MinWidth","200")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","SalesPerson","MinWidth","50")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","PRICE","MinWidth","100")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","BO_EXTENSION","MinWidth","100")

	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Customer","Fixed","Left")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Name_Customer","Fixed","Left")

	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","USER_4","CellBackColor","LightYellow")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","USER_5","CellBackColor","LightYellow")
	
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","NOTES","CellBackColor","Gray")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","NOTES","CellForeColor","White")

	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Qty_BO","DisplayCustomNumeric","#,###,##0.00")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","PRICE","DisplayCustomNumeric","#,###,##0.00")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","BO_EXTENSION","DisplayCustomNumeric","#,###,##0.00")

	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","Item_Promise_Dt","DisplayCustomDatetime","d")
	Gui.FrmSOMain.GsGCDueSO.SetColumnProperty("gvDueSO","MUST_DLVR_BY_DATE","DisplayCustomDatetime","d")

	Gui.frmSOMain.GsGCDueSO.ResumeLayout()
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.loadDVGVDueSO.End

Program.Sub.GsGCAllSO_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.stemp.Declare(string)
	V.Local.sCaption.Declare

	'Opening up other programs when ORDER # is clicked. CallWrapper #'s can be found in web help.
	F.Intrinsic.Control.If(v.Args.column,=,"Order_NO")
		Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","Order_NO",v.Args.RowIndex,v.Local.stemp)
		f.Intrinsic.Control.If(v.Screen.FrmSOMain!optEdit.Value,=,True)
			F.Intrinsic.String.Concat(V.Local.stemp,"!*!O!*!*!*ZDR*!*",v.Local.stemp)
			F.Global.General.CallWrapperSync(200000,v.Local.stemp)

		f.Intrinsic.Control.ElseIf(v.Screen.FrmSOMain!optShip.Value,=,True)
			F.Global.General.CallWrapperSync(4010,v.Local.stemp)

		f.Intrinsic.Control.Else
			f.Intrinsic.String.Concat(v.Local.stemp,"!*!V!*!*!*ZDR*!*",v.Local.stemp)
			f.Global.General.CallWrapperSync(200000,v.Local.stemp)
		f.Intrinsic.Control.EndIf
	F.Intrinsic.Control.ElseIf(V.Args.Column,=,"NOTES")
			Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","ORDER_NO",V.Args.RowIndex,V.Global.sOrderNo)
			Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","RECORD_NO",V.Args.RowIndex,V.Global.sOrderLn)
			Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","NAME_CUSTOMER",V.Args.RowIndex,V.Global.sCustomer)
			Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","SALESPERSON",V.Args.RowIndex,V.Global.sSalesperson)
			Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","CUSTOMER_PO",V.Args.RowIndex,V.Global.sCustPO)
			Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","PART",V.Args.RowIndex,V.Global.sPart)
			Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","DESCRIPTION",V.Args.RowIndex,V.Global.sPaerDesc)
			Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","QTY_BO",V.Args.RowIndex,V.Global.fQty)
			Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","ITEM_PROMISE_DT",V.Args.RowIndex,V.Global.dDueDate)
			F.Intrinsic.String.RPad(V.Global.sOrderLn,"0",4,V.Global.sOrderLn)
			F.Intrinsic.String.Build("Notes: {0}-{1}",V.Global.sOrderNo,V.Global.sOrderLn,V.Local.sCaption)
			Gui.frmNotes..Caption(V.Local.sCaption)
			F.Intrinsic.Control.CallSub(LoadDtNotes)
			F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCAllSO_RowCellClick.End

Program.Sub.GsGCDueSO_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	v.Local.stemp.Declare(string)
	V.Local.sCaption.Declare

	'Opening up other programs when ORDER # is clicked. CallWrapper #'s can be found in web help.
	F.Intrinsic.Control.If(v.Args.column,=,"Order_NO")
		Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","Order_NO",v.Args.RowIndex,v.Local.stemp)
		f.Intrinsic.Control.If(v.Screen.FrmSOMain!optEdit.Value,=,True)
			F.Intrinsic.String.Concat(V.Local.stemp,"!*!O!*!*!*ZDR*!*",v.Local.stemp)
			F.Global.General.CallWrapperSync(200000,v.Local.stemp)
		f.Intrinsic.Control.ElseIf(v.Screen.FrmSOMain!optShip.Value,=,True)
			F.Global.General.CallWrapperSync(4010,v.Local.stemp)
		f.Intrinsic.Control.Else
			f.Intrinsic.String.Concat(v.Local.stemp,"!*!V!*!*!*ZDR*!*",v.Local.stemp)
			f.Global.General.CallWrapperSync(200000,v.Local.stemp)
		f.Intrinsic.Control.EndIf
	F.Intrinsic.Control.ElseIf(V.Args.Column,=,"NOTES")
			Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","ORDER_NO",V.Args.RowIndex,V.Global.sOrderNo)
			Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","RECORD_NO",V.Args.RowIndex,V.Global.sOrderLn)
			Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","NAME_CUSTOMER",V.Args.RowIndex,V.Global.sCustomer)
			Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","SALESPERSON",V.Args.RowIndex,V.Global.sSalesperson)
			Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","CUSTOMER_PO",V.Args.RowIndex,V.Global.sCustPO)
			Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","PART",V.Args.RowIndex,V.Global.sPart)
			Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","DESCRIPTION",V.Args.RowIndex,V.Global.sPaerDesc)
			Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","QTY_BO",V.Args.RowIndex,V.Global.fQty)
			Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","ITEM_PROMISE_DT",V.Args.RowIndex,V.Global.dDueDate)
			F.Intrinsic.String.RPad(V.Global.sOrderLn,"0",4,V.Global.sOrderLn)
			F.Intrinsic.String.Build("Notes: {0}-{1}",V.Global.sOrderNo,V.Global.sOrderLn,V.Local.sCaption)
			Gui.frmNotes..Caption(V.Local.sCaption)
			F.Intrinsic.Control.CallSub(LoadDtNotes)
			F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCDueSO_RowCellClick.End

Program.Sub.GsGCAllSO_CellValueChanged.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.sSQL.Declare
	V.Local.sOrder.Declare
	V.Local.sSOLine.Declare
	V.Local.sLine.Declare
	V.Local.sText.Declare
	V.Local.sTextTbl.Declare

	F.Intrinsic.Control.SelectCase(V.Args.column)
		F.Intrinsic.Control.Case("USER_4")
			Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","Order_NO",V.Args.RowIndex,V.Local.sOrder)
			Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","Record_NO",V.Args.RowIndex,V.Local.sLine)
			F.Intrinsic.String.RPad(V.Local.sLine,"0",4,V.Local.sSOLine)
			F.Intrinsic.String.Left(V.Args.Value,30,V.Local.sText)
			F.Intrinsic.String.Replace(V.Local.sText,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM ORDER_LINES WHERE ORDER_NO = '{0}' AND RECORD_NO = '{1}';",V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO ORDER_LINES(ORDER_NO,RECORD_NO,USER_4) VALUES('{0}','{1}','{2}');",V.Local.sOrder,V.Local.sSOLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE ORDER_LINES SET USER_4 = '{0}' WHERE ORDER_NO = '{1}' AND RECORD_NO = '{2}';",V.Local.sTextTbl,V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"SO",V.Local.sOrder,"Line",V.Local.sLine,"Note",V.Local.sText,"GV","gvAllSO","SO_Note","USER_4")

		F.Intrinsic.Control.Case("USER_5")
			Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","Order_NO",V.Args.RowIndex,V.Local.sOrder)
			Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","Record_NO",V.Args.RowIndex,V.Local.sLine)
			F.Intrinsic.String.RPad(V.Local.sLine,"0",4,V.Local.sSOLine)
			F.Intrinsic.String.Left(V.Args.Value,30,V.Local.sText)
			F.Intrinsic.String.Replace(V.Local.sText,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM ORDER_LINES WHERE ORDER_NO = '{0}' AND RECORD_NO = '{1}';",V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO ORDER_LINES(ORDER_NO,RECORD_NO,USER_5) VALUES('{0}','{1}','{2}');",V.Local.sOrder,V.Local.sSOLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE ORDER_LINES SET USER_5 = '{0}' WHERE ORDER_NO = '{1}' AND RECORD_NO = '{2}';",V.Local.sTextTbl,V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"SO",V.Local.sOrder,"Line",V.Local.sLine,"Note",V.Local.sText,"GV","gvAllSO","SO_Note","USER_5")
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCAllSO_CellValueChanged.End

Program.Sub.GsGCDueSO_CellValueChanged.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.sSQL.Declare
	V.Local.sOrder.Declare
	V.Local.sLine.Declare
	V.Local.sText.Declare
	V.Local.sTextTbl.Declare
	V.Local.sSOLine.Declare

	F.Intrinsic.Control.SelectCase(V.Args.column)
		F.Intrinsic.Control.Case("USER_4")
			Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","Order_NO",V.Args.RowIndex,V.Local.sOrder)
			Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","Record_NO",V.Args.RowIndex,V.Local.sLine)
			F.Intrinsic.String.RPad(V.Local.sLine,"0",4,V.Local.sSOLine)
			F.Intrinsic.String.Left(V.Args.Value,30,V.Local.sText)
			F.Intrinsic.String.Replace(V.Local.sText,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM ORDER_LINES WHERE ORDER_NO = '{0}' AND RECORD_NO = '{1}';",V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO ORDER_LINES(ORDER_NO,RECORD_NO,USER_4) VALUES('{0}','{1}','{2}');",V.Local.sOrder,V.Local.sSOLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE ORDER_LINES SET USER_4 = '{0}' WHERE ORDER_NO = '{1}' AND RECORD_NO = '{2}';",V.Local.sTextTbl,V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"SO",V.Local.sOrder,"Line",V.Local.sLine,"Note",V.Local.sText,"GV","GsGCDueSO","SO_Note","USER_4")

		F.Intrinsic.Control.Case("USER_5")
			Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","Order_NO",V.Args.RowIndex,V.Local.sOrder)
			Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","Record_NO",V.Args.RowIndex,V.Local.sLine)
			F.Intrinsic.String.RPad(V.Local.sLine,"0",4,V.Local.sSOLine)
			F.Intrinsic.String.Left(V.Args.Value,30,V.Local.sText)
			F.Intrinsic.String.Replace(V.Local.sText,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM ORDER_LINES WHERE ORDER_NO = '{0}' AND RECORD_NO = '{1}';",V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO ORDER_LINES(ORDER_NO,RECORD_NO,USER_5) VALUES('{0}','{1}','{2}');",V.Local.sOrder,V.Local.sSOLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE ORDER_LINES SET USER_5 = '{0}' WHERE ORDER_NO = '{1}' AND RECORD_NO = '{2}';",V.Local.sTextTbl,V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"SO",V.Local.sOrder,"Line",V.Local.sLine,"Note",V.Local.sText,"GV","GsGCDueSO","SO_Note","USER_5")
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCDueSO_CellValueChanged.End

Program.Sub.GsGCAllSO_ColumnFilterChanged.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.bFilter.Declare	
	V.Local.sFilter.Declare
	V.Local.sInvalid.Declare
	V.Local.bRet.Declare
	V.Local.iCnt.Declare
	V.Local.iCounter.Declare(Long,0)
	V.Local.sMsg.Declare

	F.Intrinsic.String.Split("StartsWith*!*Between*!*Contains*!*EndsWith*!*IsNullOrEmpty*!*?*!*IsOutlookInterval","*!*",V.Local.sInvalid)
	F.Intrinsic.String.IsNullOrWhiteSpace(V.Args.ActiveFilterExpression,V.Local.bFilter)
	F.Intrinsic.Control.If(V.Local.bFilter,=,True)
		F.Intrinsic.Control.CallSub(OrderTotal,"Load","FirstLoad","Filter","ORDER_NO LIKE '%%'")
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Replace(V.Args.ActiveFilterExpression,"[","",V.Local.sFilter)
		F.Intrinsic.String.Replace(V.Local.sFilter,"]","",V.Local.sFilter)
		F.Intrinsic.String.Replace(V.Local.sFilter,"0m","",V.Local.sFilter)

		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sInvalid.UBound,1)
			F.Intrinsic.String.IsInString(V.Local.sFilter,V.Local.sInvalid(V.Local.iCnt),False,V.Local.bRet)
			F.Intrinsic.Control.If(V.Local.bRet,=,True)
				F.Intrinsic.Math.Add(V.Local.iCounter,1,V.Local.iCounter)
			F.Intrinsic.Control.endif
		F.Intrinsic.Control.Next(V.Local.iCnt)

		F.Intrinsic.Control.If(V.Local.iCounter,=,1)
			Function.Intrinsic.String.Build("Grid will be filtered, but totals will not be recalculated, because one of the filters entered is an invalid filter for recalculating totals.{0}{0}Invalid Filters for recalculating totals:{0}- Is between{0}- Is not between{0}- Contains{0}- Does not contain{0}- Beings with{0}- Ends with{0}- Is blank{0}- Is not blank{0}- ?{0}- Calendar Checkboxes",V.Ambient.NewLine,V.Local.sMsg)
			F.Intrinsic.UI.Msgbox(V.Local.sMsg,"Filter Validation")
		F.Intrinsic.Control.ElseIf(V.Local.iCounter,>,1)
			Function.Intrinsic.String.Build("Grid will be filtered, but totals will not be recalculated, because more than one filter entered is an invalid filter for recalculating totals.{0}{0}Invalid Filters for recalculating totals:{0}- Is between{0}- Is not between{0}- Contains{0}- Does not contain{0}- Beings with{0}- Ends with{0}- Is blank{0}- Is not blank{0}- ?{0}- Calendar Checkboxes",V.Ambient.NewLine,V.Local.sMsg)
			F.Intrinsic.UI.Msgbox(V.Local.sMsg,"Filter Validation")
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.CallSub(OrderTotal,"Load","AllOpen","Filter",V.Local.sFilter)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCAllSO_ColumnFilterChanged.End

Program.Sub.GsGCDueSO_ColumnFilterChanged.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.bFilter.Declare	
	V.Local.sFilter.Declare
	V.Local.sInvalid.Declare
	V.Local.bRet.Declare
	V.Local.iCnt.Declare
	V.Local.iCounter.Declare(Long,0)
	V.Local.sMsg.Declare

	F.Intrinsic.String.Split("StartsWith*!*Between*!*Contains*!*EndsWith*!*IsNullOrEmpty*!*?*!*IsOutlookInterval","*!*",V.Local.sInvalid)
	F.Intrinsic.String.IsNullOrWhiteSpace(V.Args.ActiveFilterExpression,V.Local.bFilter)
	F.Intrinsic.Control.If(V.Local.bFilter,=,True)
		F.Intrinsic.Control.CallSub(OrderTotal,"Load","FirstLoad","Filter","ORDER_NO LIKE '%%'")
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Replace(V.Args.ActiveFilterExpression,"[","",V.Local.sFilter)
		F.Intrinsic.String.Replace(V.Local.sFilter,"]","",V.Local.sFilter)
		F.Intrinsic.String.Replace(V.Local.sFilter,"0m","",V.Local.sFilter)

		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sInvalid.UBound,1)
			F.Intrinsic.String.IsInString(V.Local.sFilter,V.Local.sInvalid(V.Local.iCnt),False,V.Local.bRet)
			F.Intrinsic.Control.If(V.Local.bRet,=,True)
				F.Intrinsic.Math.Add(V.Local.iCounter,1,V.Local.iCounter)
			F.Intrinsic.Control.endif
		F.Intrinsic.Control.Next(V.Local.iCnt)

		F.Intrinsic.Control.If(V.Local.iCounter,=,1)
			Function.Intrinsic.String.Build("Grid will be filtered, but totals will not be recalculated, because one of the filters entered is an invalid filter for recalculating totals.{0}{0}Invalid Filters for recalculating totals:{0}- Is between{0}- Is not between{0}- Contains{0}- Does not contain{0}- Beings with{0}- Ends with{0}- Is blank{0}- Is not blank{0}- ?{0}- Calendar Checkboxes",V.Ambient.NewLine,V.Local.sMsg)
			F.Intrinsic.UI.Msgbox(V.Local.sMsg,"Filter Validation")
		F.Intrinsic.Control.ElseIf(V.Local.iCounter,>,1)
			Function.Intrinsic.String.Build("Grid will be filtered, but totals will not be recalculated, because more than one filter entered is an invalid filter for recalculating totals.{0}{0}Invalid Filters for recalculating totals:{0}- Is between{0}- Is not between{0}- Contains{0}- Does not contain{0}- Beings with{0}- Ends with{0}- Is blank{0}- Is not blank{0}- ?{0}- Calendar Checkboxes",V.Ambient.NewLine,V.Local.sMsg)
			F.Intrinsic.UI.Msgbox(V.Local.sMsg,"Filter Validation")
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.CallSub(OrderTotal,"Load","PastDue","Filter",V.Local.sFilter)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCDueSO_ColumnFilterChanged.End

Program.Sub.OrderTotal.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.fTotal.Declare
	V.Local.sTotal.Declare

	Function.Intrinsic.Control.SelectCase(V.Args.Load)
		Function.Intrinsic.Control.Case("FirstLoad")
			F.Data.DataTable.Compute("dtAllSO","SUM(BO_EXTENSION)",V.Args.Filter,V.Local.fTotal)
			F.Intrinsic.String.Format(V.Local.fTotal,"#,###,###,##0.00",V.Local.sTotal)
			Gui.FrmSOMain.txtAllTotal.Text(V.Local.sTotal)
			Gui.FrmSOMain.txtChartTotal.Text(V.Local.sTotal)

			F.Data.DataTable.Compute("dtdueSO","SUM(BO_EXTENSION)",V.Args.Filter,V.Local.fTotal)
			F.Intrinsic.String.Format(V.Local.fTotal,"#,###,###,##0.00",V.Local.sTotal)
			Gui.FrmSOMain.txtPastDueTotal.Text(V.Local.sTotal)

		Function.Intrinsic.Control.Case("AllOpen")
			F.Data.DataTable.Compute("dtAllSO","SUM(BO_EXTENSION)",V.Args.Filter,V.Local.fTotal)
			F.Intrinsic.String.Format(V.Local.fTotal,"#,###,###,##0.00",V.Local.sTotal)
			Gui.FrmSOMain.txtAllTotal.Text(V.Local.sTotal)

		Function.Intrinsic.Control.Case("PastDue")
			F.Data.DataTable.Compute("dtdueSO","SUM(BO_EXTENSION)",V.Args.Filter,V.Local.fTotal)
			F.Intrinsic.String.Format(V.Local.fTotal,"#,###,###,##0.00",V.Local.sTotal)
			Gui.FrmSOMain.txtPastDueTotal.Text(V.Local.sTotal)
	Function.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.OrderTotal.End

Program.Sub.Charts2.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.iCnt.Declare
	V.Local.iC.Declare
	V.Local.sSeries.Declare
	V.Local.sCustomers.Declare
	V.Local.sCustArray.Declare
	V.Local.sSales.Declare
	V.Local.sSalesArray.Declare
	V.Local.sSP.Declare
	V.Local.sSPArray.Declare
	V.Local.sPL.Declare
	V.Local.sPLArray.Declare
	V.Local.fOther.Declare

	Gui.FrmSOMain.lblStatus.Caption("Loading Sales Statistics....")

	F.Intrinsic.Control.If(V.DataTable.dtCustomers.Exists)
		F.Data.DataTable.Close("dtCustomers")
		F.Data.DataTable.Close("dtCustomersD")
		F.Data.DataTable.Close("dtSP")
		F.Data.DataTable.Close("dtSPD")
		F.Data.DataTable.Close("dtPL")
		F.Data.DataTable.Close("dtPLD")
		Gui.FrmCustomer.gsCustomer.ClearChart
		Gui.FrmPL.gsPL.ClearChart
		Gui.FrmSalesPerson.gsSalesperson.ClearChart
		Gui.FrmSOMain.gsPL.ClearChart
		Gui.FrmSOMain.gsCustomer.ClearChart
		Gui.FrmSOMain.gsSalesPerson.ClearChart
	F.Intrinsic.Control.EndIf

	'Check Total Sales
	F.ODBC.Connection!con.ExecuteAndReturn("SELECT SUM(CASE WHEN VOL.FLAG_USE_MQD != 'Y' THEN (VOL.QTY_BO*VOL.DISCOUNT_PRICE) WHEN FLAG_USE_MQD = 'Y' THEN (VOSS.QTY_OPEN*VOL.DISCOUNT_PRICE) WHEN VOL.DISCOUNT_PRICE = 0 THEN 0.00 END) FROM V_ORDER_LINES VOL LEFT JOIN V_OE_SHIP_SCHED VOSS ON VOSS.ORDER_NO = VOL.ORDER_NO AND VOSS.ORDER_LINE = VOL.RECORD_NO WHERE QTY_BO <> 0 AND LINE_TYPE <> 'F' and LINE_TYPE <> 'P';",V.Local.fOther)
	F.Intrinsic.Control.If(V.Local.fOther,=,0)
		F.Intrinsic.UI.Msgbox("Total Sales is currently zero. Graphs will not be populated.","Totals Sales")
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf

	'Customer Sales Stats
	F.Data.DataTable.CreateFromSQL("dtCustomers","con","SELECT IF(A.CUSTOMER <> '',A.CUSTOMER,'Misc.') AS CUSTOMER,IF(NAME_CUSTOMER <> '',NAME_CUSTOMER,'Misc.') AS NAME_CUSTOMER,SUM(CAST(QTY_BO*PRICE AS NUMERIC(16,6))) AS CUST_TOTAL,(SELECT SUM(CASE WHEN VOL.FLAG_USE_MQD != 'Y' THEN (VOL.QTY_BO*VOL.DISCOUNT_PRICE) WHEN FLAG_USE_MQD = 'Y' THEN (VOSS.QTY_OPEN*VOL.DISCOUNT_PRICE) WHEN VOL.DISCOUNT_PRICE = 0 THEN 0.00 END) AS BO_EXTENSION FROM V_ORDER_LINES VOL LEFT JOIN V_OE_SHIP_SCHED VOSS ON VOSS.ORDER_NO = VOL.ORDER_NO AND VOSS.ORDER_LINE = VOL.RECORD_NO WHERE QTY_BO <> 0 AND LINE_TYPE <> 'F' and LINE_TYPE <> 'P') AS TOTAL_SALES,Case When (SELECT SUM(CASE WHEN VOL.FLAG_USE_MQD != 'Y' THEN (VOL.QTY_BO*VOL.DISCOUNT_PRICE) WHEN FLAG_USE_MQD = 'Y' THEN (VOSS.QTY_OPEN*VOL.DISCOUNT_PRICE) WHEN VOL.DISCOUNT_PRICE = 0 THEN 0.00 END) FROM V_ORDER_LINES VOL LEFT JOIN V_OE_SHIP_SCHED VOSS ON VOSS.ORDER_NO = VOL.ORDER_NO AND VOSS.ORDER_LINE = VOL.RECORD_NO WHERE QTY_BO <> 0 AND LINE_TYPE <> 'F' and LINE_TYPE <> 'P') = 0 Then 0 Else CAST((SUM(CAST(QTY_BO*PRICE AS NUMERIC(16,6)))/(SELECT SUM(CASE WHEN VOL.FLAG_USE_MQD != 'Y' THEN (VOL.QTY_BO*VOL.DISCOUNT_PRICE) WHEN FLAG_USE_MQD = 'Y' THEN (VOSS.QTY_OPEN*VOL.DISCOUNT_PRICE) WHEN VOL.DISCOUNT_PRICE = 0 THEN 0.00 END) AS BO_EXTENSION FROM V_ORDER_LINES VOL LEFT JOIN V_OE_SHIP_SCHED VOSS ON VOSS.ORDER_NO = VOL.ORDER_NO AND VOSS.ORDER_LINE = VOL.RECORD_NO WHERE QTY_BO <> 0 AND LINE_TYPE <> 'F' and LINE_TYPE <> 'P'))*100 AS NUMERIC(16,6)) End AS PERCENTOFSALES FROM V_ORDER_LINES A LEFT JOIN V_CUSTOMER_MASTER B ON A.CUSTOMER = B.CUSTOMER WHERE QTY_BO <> 0 AND LINE_TYPE <> 'F' AND LINE_TYPE <> 'P' GROUP BY A.CUSTOMER,NAME_CUSTOMER ORDER BY CUST_TOTAL DESC;",True)
	F.Data.DataView.Create("dtCustomers","dvCustomers")
	F.Data.DataView.ToDataTableDistinct("dtCustomers","dvCustomers","dtCustomersD","NAME_CUSTOMER*!*PERCENTOFSALES",True)

	V.Local.iC.Set(0)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtCustomersD.RowCount--,1)
		F.Intrinsic.Control.If(V.Local.iC,=,0)
			F.Intrinsic.Math.Add(V.Local.iC,1,V.Local.iC)
			F.Intrinsic.String.Build("{0}*!*",V.DataTable.dtCustomersD(V.Local.iCnt).NAME_CUSTOMER!FieldValTrim,V.Local.sCustomers)
			F.Intrinsic.String.Build("{0}*!*",V.DataTable.dtCustomersD(V.Local.iCnt).PERCENTOFSALES!FieldVal,V.Local.sSales)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("{0}#$#{1}*!*",V.Local.sCustomers,V.DataTable.dtCustomersD(V.Local.iCnt).NAME_CUSTOMER!FieldValTrim,V.Local.sCustomers)
			F.Intrinsic.String.Build("{0}#$#{1}*!*",V.Local.sSales,V.DataTable.dtCustomersD(V.Local.iCnt).PERCENTOFSALES!FieldVal,V.Local.sSales)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)

	F.Intrinsic.String.Replace(V.Local.sCustomers,"*!*","",V.Local.sCustomers)
	F.Intrinsic.String.Replace(V.Local.sCustomers,"#$#","*!*",V.Local.sCustomers)
	F.Intrinsic.String.Replace(V.Local.sSales,"*!*","",V.Local.sSales)
	F.Intrinsic.String.Replace(V.Local.sSales,"#$#","*!*",V.Local.sSales)

	V.Local.iC.Set(0)
	V.Local.fOther.Set(0)
	F.Intrinsic.String.Split(V.Local.sCustomers,"*!*",V.Local.sCustArray)
	F.Intrinsic.String.Split(V.Local.sSales,"*!*",V.Local.sSalesArray)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSalesArray.UBound,1)
		F.Intrinsic.Control.If(V.Local.sSalesArray(V.Local.iCnt).Float,>,V.Global.iPercent)
			F.Intrinsic.Control.If(V.Local.iC,=,0)
				F.Intrinsic.Math.Add(V.Local.iC,1,V.Local.iC)
				F.Intrinsic.String.Build("{0}*!*",V.Local.sCustArray(V.Local.iCnt),V.Local.sCustomers)
				F.Intrinsic.String.Build("{0}*!*",V.Local.sSalesArray(V.Local.iCnt),V.Local.sSales)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("{0}#$#{1}*!*",V.Local.sCustomers,V.Local.sCustArray(V.Local.iCnt),V.Local.sCustomers)
				F.Intrinsic.String.Build("{0}#$#{1}*!*",V.Local.sSales,V.Local.sSalesArray(V.Local.iCnt),V.Local.sSales)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			F.Intrinsic.Math.Add(V.Local.fOther,V.Local.sSalesArray(V.Local.iCnt).Float,V.Local.fOther)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)

	F.Intrinsic.String.Build("{0}#$#{1}*!*",V.Local.sCustomers,"Other",V.Local.sCustomers)
	F.Intrinsic.String.Build("{0}#$#{1}*!*",V.Local.sSales,V.Local.fOther,V.Local.sSales)

	F.Intrinsic.String.Replace(V.Local.sCustomers,"*!*","",V.Local.sCustomers)
	F.Intrinsic.String.Replace(V.Local.sCustomers,"#$#","*!*",V.Local.sCustomers)
	F.Intrinsic.String.Replace(V.Local.sSales,"*!*","",V.Local.sSales)
	F.Intrinsic.String.Replace(V.Local.sSales,"#$#","*!*",V.Local.sSales)
	F.Intrinsic.String.Build("{0}!*!{1}",V.Local.sCustomers,V.Local.sSales,V.Local.sSeries)
	Gui.FrmSOMain.gsCustomer.CreatePieChart("Customer Sales Stats","C1",V.Local.sSeries)
	Gui.FrmCustomer.gsCustomer.CreatePieChart("Customer Sales Stats","C2",V.Local.sSeries)

	F.Data.DataTable.RemoveColumn("dtCustomers","CUSTOMER")
	F.Data.DataTable.RemoveColumn("dtCustomers","CUST_TOTAL")
	F.Data.DataTable.RemoveColumn("dtCustomers","TOTAL_SALES")

	Gui.FrmCustomer.GsGridControlCustomerStat.AddGridViewFromDataTable("gvCust","dtCustomers")
	Gui.FrmCustomer.GsGridControlCustomerStat.SetGridViewProperty("gvCust","MultiSelect",True)
	Gui.FrmCustomer.GsGridControlCustomerStat.SetGridViewProperty("gvCust","AllowSort",False)
	Gui.FrmCustomer.GsGridControlCustomerStat.SetGridViewProperty("gvCust","AllowFilter",False)
	Gui.FrmCustomer.GsGridControlCustomerStat.SetGridViewProperty("gvCust","OptionsDetailShowDetailTabs",False)
	Gui.FrmCustomer.GsGridControlCustomerStat.SetGridViewProperty("gvCust","OptionsViewShowGroupPanel",False)
	Gui.FrmCustomer.GsGridControlCustomerStat.SetGridViewProperty("gvCust","Enableappearanceoddrow",True)

	Gui.FrmCustomer.GsGridControlCustomerStat.SetColumnProperty("gvCust","NAME_CUSTOMER","Caption","Customer Name")
	Gui.FrmCustomer.GsGridControlCustomerStat.SetColumnProperty("gvCust","PERCENTOFSALES","Caption","% of Sales")

	Gui.FrmCustomer.GsGridControlCustomerStat.SetColumnProperty("gvCust","NAME_CUSTOMER","AllowEdit",False)
	Gui.FrmCustomer.GsGridControlCustomerStat.SetColumnProperty("gvCust","PERCENTOFSALES","AllowEdit",False)

	Gui.FrmCustomer.GsGridControlCustomerStat.SetColumnProperty("gvCust","NAME_CUSTOMER","MinWidth","178")
	Gui.FrmCustomer.GsGridControlCustomerStat.SetColumnProperty("gvCust","PERCENTOFSALES","MinWidth","50")

	Gui.FrmCustomer.GsGridControlCustomerStat.SetColumnProperty("gvCust","PERCENTOFSALES","CellHalignment","Far")
	Gui.FrmCustomer.GsGridControlCustomerStat.SetColumnProperty("gvCust","PERCENTOFSALES","DisplayCustomNumeric","##0.000")

	Gui.FrmCustomer.GsGridControlCustomerStat.MainView("gvCust")

	'Salesperson Stats
	F.Data.DataTable.CreateFromSQL("dtSP","con","SELECT IF(SALESPERSON <> '',SALESPERSON,'Misc.') AS SALESPERSON,SUM(CAST(QTY_BO*PRICE AS NUMERIC(16,6))) AS CUST_TOTAL,(SELECT SUM(CASE WHEN VOL.FLAG_USE_MQD != 'Y' THEN (VOL.QTY_BO*VOL.DISCOUNT_PRICE) WHEN FLAG_USE_MQD = 'Y' THEN (VOSS.QTY_OPEN*VOL.DISCOUNT_PRICE) WHEN VOL.DISCOUNT_PRICE = 0 THEN 0.00 END) AS BO_EXTENSION FROM V_ORDER_LINES VOL LEFT JOIN V_OE_SHIP_SCHED VOSS ON VOSS.ORDER_NO = VOL.ORDER_NO AND VOSS.ORDER_LINE = VOL.RECORD_NO WHERE QTY_BO <> 0 AND LINE_TYPE <> 'F' and LINE_TYPE <> 'P') AS TOTAL_SALES,CAST((SUM(CAST(QTY_BO*PRICE AS NUMERIC(16,6)))/(SELECT SUM(CAST(QTY_BO*PRICE AS NUMERIC(16,6))) AS TOTAL_SALES FROM V_ORDER_LINES))*100 AS NUMERIC(16,6)) AS PERCENTOFSALES FROM V_ORDER_LINES A LEFT JOIN V_ORDER_HEADER B ON A.ORDER_NO = B.ORDER_NO WHERE QTY_BO <> 0 AND LINE_TYPE <> 'F' AND LINE_TYPE <> 'P' GROUP BY SALESPERSON ORDER BY CUST_TOTAL DESC;",True)
	F.Data.DataView.Create("dtSP","dvSP")
	F.Data.DataView.ToDataTableDistinct("dtSP","dvSP","dtSPD","SALESPERSON*!*PERCENTOFSALES",True)

	V.Local.iC.Set(0)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtSPD.RowCount--,1)
		F.Intrinsic.Control.If(V.Local.iC,=,0)
			F.Intrinsic.Math.Add(V.Local.iC,1,V.Local.iC)
			F.Intrinsic.String.Build("{0}*!*",V.DataTable.dtSPD(V.Local.iCnt).SALESPERSON!FieldValTrim,V.Local.sSP)
			F.Intrinsic.String.Build("{0}*!*",V.DataTable.dtSPD(V.Local.iCnt).PERCENTOFSALES!FieldVal,V.Local.sSales)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("{0}#$#{1}*!*",V.Local.sSP,V.DataTable.dtSPD(V.Local.iCnt).SALESPERSON!FieldValTrim,V.Local.sSP)
			F.Intrinsic.String.Build("{0}#$#{1}*!*",V.Local.sSales,V.DataTable.dtSPD(V.Local.iCnt).PERCENTOFSALES!FieldVal,V.Local.sSales)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)

	F.Intrinsic.String.Replace(V.Local.sSP,"*!*","",V.Local.sSP)
	F.Intrinsic.String.Replace(V.Local.sSP,"#$#","*!*",V.Local.sSP)
	F.Intrinsic.String.Replace(V.Local.sSales,"*!*","",V.Local.sSales)
	F.Intrinsic.String.Replace(V.Local.sSales,"#$#","*!*",V.Local.sSales)	

	V.Local.iC.Set(0)
	V.Local.fOther.Set(0)
	F.Intrinsic.String.Split(V.Local.sSP,"*!*",V.Local.sSPArray)
	F.Intrinsic.String.Split(V.Local.sSales,"*!*",V.Local.sSalesArray)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSalesArray.UBound,1)
		F.Intrinsic.Control.If(V.Local.sSalesArray(V.Local.iCnt).Float,>,V.Global.iPercent)
			F.Intrinsic.Control.If(V.Local.iC,=,0)
				F.Intrinsic.Math.Add(V.Local.iC,1,V.Local.iC)
				F.Intrinsic.String.Build("{0}*!*",V.Local.sSPArray(V.Local.iCnt),V.Local.sSP)
				F.Intrinsic.String.Build("{0}*!*",V.Local.sSalesArray(V.Local.iCnt),V.Local.sSales)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("{0}#$#{1}*!*",V.Local.sSP,V.Local.sSPArray(V.Local.iCnt),V.Local.sSP)
				F.Intrinsic.String.Build("{0}#$#{1}*!*",V.Local.sSales,V.Local.sSalesArray(V.Local.iCnt),V.Local.sSales)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			F.Intrinsic.Math.Add(V.Local.fOther,V.Local.sSalesArray(V.Local.iCnt).Float,V.Local.fOther)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)

	F.Intrinsic.String.Build("{0}#$#{1}*!*",V.Local.sSP,"Other",V.Local.sSP)
	F.Intrinsic.String.Build("{0}#$#{1}*!*",V.Local.sSales,V.Local.fOther,V.Local.sSales)

	F.Intrinsic.String.Replace(V.Local.sSP,"*!*","",V.Local.sSP)
	F.Intrinsic.String.Replace(V.Local.sSP,"#$#","*!*",V.Local.sSP)
	F.Intrinsic.String.Replace(V.Local.sSales,"*!*","",V.Local.sSales)
	F.Intrinsic.String.Replace(V.Local.sSales,"#$#","*!*",V.Local.sSales)
	F.Intrinsic.String.Build("{0}!*!{1}",V.Local.sSP,V.Local.sSales,V.Local.sSeries)
	Gui.FrmSOMain.gsSalesPerson.CreatePieChart("Salesperson Stats","S1",V.Local.sSeries)
	Gui.FrmSalesperson.gsSalesperson.CreatePieChart("Salesperson Sales Stats","S2",V.Local.sSeries)

	F.Data.DataTable.RemoveColumn("dtSP","CUST_TOTAL")
	F.Data.DataTable.RemoveColumn("dtSP","TOTAL_SALES")

	Gui.FrmSalesperson.GsGridControlSalespersonStat.AddGridViewFromDataTable("gvSP","dtSP")
	Gui.FrmSalesperson.GsGridControlSalespersonStat.SetGridViewProperty("gvSP","MultiSelect",True)
	Gui.FrmSalesperson.GsGridControlSalespersonStat.SetGridViewProperty("gvSP","AllowSort",False)
	Gui.FrmSalesperson.GsGridControlSalespersonStat.SetGridViewProperty("gvSP","AllowFilter",False)
	Gui.FrmSalesperson.GsGridControlSalespersonStat.SetGridViewProperty("gvSP","OptionsDetailShowDetailTabs",False)
	Gui.FrmSalesperson.GsGridControlSalespersonStat.SetGridViewProperty("gvSP","OptionsViewShowGroupPanel",False)
	Gui.FrmSalesperson.GsGridControlSalespersonStat.SetGridViewProperty("gvSP","Enableappearanceoddrow",True)

	Gui.FrmSalesperson.GsGridControlSalespersonStat.SetColumnProperty("gvSP","SALESPERSON","Caption","Salesperson")
	Gui.FrmSalesperson.GsGridControlSalespersonStat.SetColumnProperty("gvSP","PERCENTOFSALES","Caption","% of Sales")

	Gui.FrmSalesperson.GsGridControlSalespersonStat.SetColumnProperty("gvSP","SALESPERSON","AllowEdit",False)
	Gui.FrmSalesperson.GsGridControlSalespersonStat.SetColumnProperty("gvSP","PERCENTOFSALES","AllowEdit",False)

	Gui.FrmSalesperson.GsGridControlSalespersonStat.SetColumnProperty("gvSP","SALESPERSON","MinWidth","50")
	Gui.FrmSalesperson.GsGridControlSalespersonStat.SetColumnProperty("gvSP","PERCENTOFSALES","MinWidth","50")

	Gui.FrmSalesperson.GsGridControlSalespersonStat.SetColumnProperty("gvSP","PERCENTOFSALES","CellHalignment","Far")
	Gui.FrmSalesperson.GsGridControlSalespersonStat.SetColumnProperty("gvSP","PERCENTOFSALES","DisplayCustomNumeric","##0.000")

	Gui.FrmSalesperson.GsGridControlSalespersonStat.MainView("gvSP")

	'Product Line Stats
	F.Data.DataTable.CreateFromSQL("dtPL","con","SELECT IF(A.PRODUCT_LINE <> '',A.PRODUCT_LINE,'Misc.') AS PRODUCT_LINE,IF(PRODUCT_LINE_NAME <> '',PRODUCT_LINE_NAME,'Misc.') AS PRODUCT_LINE_NAME,SUM(CAST(QTY_BO*PRICE AS NUMERIC(16,6))) AS CUST_TOTAL,(SELECT SUM(CASE WHEN VOL.FLAG_USE_MQD != 'Y' THEN (VOL.QTY_BO*VOL.DISCOUNT_PRICE) WHEN FLAG_USE_MQD = 'Y' THEN (VOSS.QTY_OPEN*VOL.DISCOUNT_PRICE) WHEN VOL.DISCOUNT_PRICE = 0 THEN 0.00 END) AS BO_EXTENSION FROM V_ORDER_LINES VOL LEFT JOIN V_OE_SHIP_SCHED VOSS ON VOSS.ORDER_NO = VOL.ORDER_NO AND VOSS.ORDER_LINE = VOL.RECORD_NO WHERE QTY_BO <> 0 AND LINE_TYPE <> 'F' and LINE_TYPE <> 'P') AS TOTAL_SALES,CAST((SUM(CAST(QTY_BO*PRICE AS NUMERIC(16,6)))/(SELECT SUM(CAST(QTY_BO*PRICE AS NUMERIC(16,6))) AS TOTAL_SALES FROM V_ORDER_LINES))*100 AS NUMERIC(16,6)) AS PERCENTOFSALES FROM V_ORDER_LINES A LEFT JOIN V_PRODUCT_LINE B ON A.PRODUCT_LINE = B.PRODUCT_LINE WHERE QTY_BO <> 0 AND LINE_TYPE <> 'F' AND LINE_TYPE <> 'P' GROUP BY A.PRODUCT_LINE,PRODUCT_LINE_NAME ORDER BY CUST_TOTAL DESC;",True)
	F.Data.DataView.Create("dtPL","dvPL")
	F.Data.DataView.ToDataTableDistinct("dtPL","dvPL","dtPLD","PRODUCT_LINE*!*PERCENTOFSALES",True)

	V.Local.iC.Set(0)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtPLD.RowCount--,1)
		F.Intrinsic.Control.If(V.Local.iC,=,0)
			F.Intrinsic.Math.Add(V.Local.iC,1,V.Local.iC)
			F.Intrinsic.String.Build("{0}*!*",V.DataTable.dtPLD(V.Local.iCnt).PRODUCT_LINE!FieldValTrim,V.Local.sPL)
			F.Intrinsic.String.Build("{0}*!*",V.DataTable.dtPLD(V.Local.iCnt).PERCENTOFSALES!FieldVal,V.Local.sSales)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("{0}#$#{1}*!*",V.Local.sPL,V.DataTable.dtPLD(V.Local.iCnt).PRODUCT_LINE!FieldValTrim,V.Local.sPL)
			F.Intrinsic.String.Build("{0}#$#{1}*!*",V.Local.sSales,V.DataTable.dtPLD(V.Local.iCnt).PERCENTOFSALES!FieldVal,V.Local.sSales)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)

	F.Intrinsic.String.Replace(V.Local.sPL,"*!*","",V.Local.sPL)
	F.Intrinsic.String.Replace(V.Local.sPL,"#$#","*!*",V.Local.sPL)
	F.Intrinsic.String.Replace(V.Local.sSales,"*!*","",V.Local.sSales)
	F.Intrinsic.String.Replace(V.Local.sSales,"#$#","*!*",V.Local.sSales)

	V.Local.iC.Set(0)
	V.Local.fOther.Set(0)
	F.Intrinsic.String.Split(V.Local.sPL,"*!*",V.Local.sPLArray)
	F.Intrinsic.String.Split(V.Local.sSales,"*!*",V.Local.sSalesArray)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSalesArray.UBound,1)
		F.Intrinsic.Control.If(V.Local.sSalesArray(V.Local.iCnt).Float,>,V.Global.iPercent)
			F.Intrinsic.Control.If(V.Local.iC,=,0)
				F.Intrinsic.Math.Add(V.Local.iC,1,V.Local.iC)
				F.Intrinsic.String.Build("{0}*!*",V.Local.sPLArray(V.Local.iCnt),V.Local.sPL)
				F.Intrinsic.String.Build("{0}*!*",V.Local.sSalesArray(V.Local.iCnt),V.Local.sSales)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("{0}#$#{1}*!*",V.Local.sPL,V.Local.sPLArray(V.Local.iCnt),V.Local.sPL)
				F.Intrinsic.String.Build("{0}#$#{1}*!*",V.Local.sSales,V.Local.sSalesArray(V.Local.iCnt),V.Local.sSales)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			F.Intrinsic.Math.Add(V.Local.fOther,V.Local.sSalesArray(V.Local.iCnt).Float,V.Local.fOther)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)

	F.Intrinsic.String.Build("{0}#$#{1}*!*",V.Local.sPL,"Other",V.Local.sPL)
	F.Intrinsic.String.Build("{0}#$#{1}*!*",V.Local.sSales,V.Local.fOther,V.Local.sSales)

	F.Intrinsic.String.Replace(V.Local.sPL,"*!*","",V.Local.sPL)
	F.Intrinsic.String.Replace(V.Local.sPL,"#$#","*!*",V.Local.sPL)
	F.Intrinsic.String.Replace(V.Local.sSales,"*!*","",V.Local.sSales)
	F.Intrinsic.String.Replace(V.Local.sSales,"#$#","*!*",V.Local.sSales)
	F.Intrinsic.String.Build("{0}!*!{1}",V.Local.sPL,V.Local.sSales,V.Local.sSeries)
	Gui.FrmSOMain.gsPL.CreatePieChart("Product Line Stats","P1",V.Local.sSeries)
	Gui.FrmPL.gsPL.CreatePieChart("PL Sales Stats","P2",V.Local.sSeries)

	F.Data.DataTable.RemoveColumn("dtPL","CUST_TOTAL")
	F.Data.DataTable.RemoveColumn("dtPL","TOTAL_SALES")

	Gui.FrmPL.GsGridControlPLStat.AddGridViewFromDataTable("gvPL","dtPL")
	Gui.FrmPL.GsGridControlPLStat.SetGridViewProperty("gvPL","MultiSelect",True)
	Gui.FrmPL.GsGridControlPLStat.SetGridViewProperty("gvPL","AllowSort",False)
	Gui.FrmPL.GsGridControlPLStat.SetGridViewProperty("gvPL","AllowFilter",False)
	Gui.FrmPL.GsGridControlPLStat.SetGridViewProperty("gvPL","OptionsDetailShowDetailTabs",False)
	Gui.FrmPL.GsGridControlPLStat.SetGridViewProperty("gvPL","OptionsViewShowGroupPanel",False)
	Gui.FrmPL.GsGridControlPLStat.SetGridViewProperty("gvPL","Enableappearanceoddrow",True)

	Gui.FrmPL.GsGridControlPLStat.SetColumnProperty("gvPL","PRODUCT_LINE","Caption","PL")
	Gui.FrmPL.GsGridControlPLStat.SetColumnProperty("gvPL","PRODUCT_LINE_NAME","Caption","PL Name")
	Gui.FrmPL.GsGridControlPLStat.SetColumnProperty("gvPL","PERCENTOFSALES","Caption","% of Sales")

	Gui.FrmPL.GsGridControlPLStat.SetColumnProperty("gvPL","PRODUCT_LINE","AllowEdit",False)
	Gui.FrmPL.GsGridControlPLStat.SetColumnProperty("gvPL","PRODUCT_LINE_NAME","AllowEdit",False)
	Gui.FrmPL.GsGridControlPLStat.SetColumnProperty("gvPL","PERCENTOFSALES","AllowEdit",False)

	Gui.FrmPL.GsGridControlPLStat.SetColumnProperty("gvPL","PRODUCT_LINE","MinWidth","30")
	Gui.FrmPL.GsGridControlPLStat.SetColumnProperty("gvPL","PRODUCT_LINE_NAME","MinWidth","150")
	Gui.FrmPL.GsGridControlPLStat.SetColumnProperty("gvPL","PERCENTOFSALES","MinWidth","50")

	Gui.FrmPL.GsGridControlPLStat.SetColumnProperty("gvPL","PERCENTOFSALES","CellHalignment","Far")
	Gui.FrmPL.GsGridControlPLStat.SetColumnProperty("gvPL","PERCENTOFSALES","DisplayCustomNumeric","##0.000")

	Gui.FrmPL.GsGridControlPLStat.MainView("gvPL")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.Charts2.End

Program.Sub.txtPercent_LostFocus.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	F.Intrinsic.Control.If(V.Screen.FrmSOMain!txtPercent.Text,<>,"")
		F.Intrinsic.Control.If(V.Screen.FrmSOMain!txtPercent.Text,<>,V.Global.iPercent)
			F.Intrinsic.Control.If(V.Screen.FrmSOMain!txtPercent.Text,>,10)
				Function.Intrinsic.UI.Msgbox("The current max is 10%.","Max")
				V.Global.iPercent.Set(10)
				Gui.FrmSOMain.txtPercent.Text(V.Global.iPercent)
			F.Intrinsic.Control.Else
				V.Global.iPercent.Set(V.Screen.FrmSOMain!txtPercent.Text)
			F.Intrinsic.Control.EndIf
			F.Global.Registry.AddValue("SUPERVSR",V.Caller.CompanyCode,"4595",4595,1000,"False","Top Percent",False,V.Global.iPercent,-999.0,1/1/1980,12:00:00 AM)
			F.Intrinsic.Control.CallSub(charts2)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.txtPercent_LostFocus.End

Program.Sub.frameCustomer_DblClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	Gui.FrmCustomer..Visible(True)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.frameCustomer_DblClick.End

Program.Sub.FrmCustomer_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	Gui.FrmCustomer..Visible(false)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.FrmCustomer_UnLoad.End

Program.Sub.framePL_DblClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	Gui.FrmPL..Visible(True)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.framePL_DblClick.End

Program.Sub.frameSalesPerson_DblClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	Gui.FrmSalesPerson..Visible(True)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.frameSalesPerson_DblClick.End

Program.Sub.FrmSalesPerson_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	Gui.FrmSalesPerson..Visible(false)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.FrmSalesPerson_UnLoad.End

Program.Sub.FrmPL_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	Gui.FrmPL..Visible(false)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.FrmPL_UnLoad.End

Program.Sub.cmdNew_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.iRowCnt.Declare
	V.Local.iRowCnt2.Declare

	F.ODBC.Connection!con.ExecuteAndReturn("SELECT COUNT(*) FROM V_ORDER_HEADER;",V.Local.iRowCnt)

	F.Intrinsic.Control.CallSub(disablecontrols)
	F.Global.General.CallWrapperSync(200000,"*!*ZDR*!*!*!N!*!*!*ZDR*!*")

	F.ODBC.Connection!con.ExecuteAndReturn("SELECT COUNT(*) FROM V_ORDER_HEADER;",V.Local.iRowCnt2)

	F.Intrinsic.Control.If(V.Local.iRowCnt,<>,V.Local.iRowCnt2)
		F.Intrinsic.Control.CallSub(cmdrefresh_click)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.CallSub(enablecontrols)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.cmdNew_Click.End

Program.Sub.DisableControls.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	Gui.FrmSOMain.lblStatus.Caption("Loading Sales Orders....")
	Gui.FrmSOMain.pbStatus.Min(0)
	Gui.FrmSOMain.pbStatus.Max(100)
	Gui.FrmSOMain.pbStatus.Value(0)
	Gui.FrmSOMain.lblStatus.Visible(True)
	Gui.FrmSOMain.pbStatus.Visible(True)
	Gui.FrmSOMain.frameButtons.Enabled(False)
	Gui.FrmSOMain.framePermissions.Enabled(False)
	Gui.FrmSOMain.tabSODash.Enabled(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.DisableControls.End

Program.Sub.EnableControls.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	Gui.FrmSOMain.frameButtons.Enabled(True)
	Gui.FrmSOMain.framePermissions.Enabled(True)
	Gui.FrmSOMain.tabSODash.Enabled(True)
	Gui.FrmSOMain.lblStatus.Visible(False)
	Gui.FrmSOMain.pbStatus.Visible(False)
	F.Intrinsic.Control.CallSub(checkpermissions)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.EnableControls.End

Program.Sub.CheckPermissions.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.bEditGrp.Declare
	V.Local.bShipGrp.Declare

	Gui.FrmSOMain.optView.Value(True)

	'Check User Permissions
	F.Global.Security.IsInGroup(v.Caller.User,"EditSO",V.Local.bEditGrp)
	F.Intrinsic.Control.If(v.Local.bEditGrp,=,True)
		Gui.FrmSOMain.optEdit.Enabled(True)
		Gui.FrmSOMain.cmdNew.Enabled(True)
	F.Intrinsic.Control.EndIf

	F.Global.Security.IsInGroup(v.Caller.User,"SHIP",V.Local.bShipGrp)
	F.Intrinsic.Control.If(v.Local.bShipGrp,=,True)
		Gui.FrmSOMain.optShip.Enabled(True)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.CheckPermissions.End

Program.Sub.tabSODash_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	F.Intrinsic.Control.If(V.Screen.FrmSOMain!tabSODash.Tab,=,0)
		Gui.FrmSOMain.lblAllTotal.Visible(True)
		Gui.FrmSOMain.txtAllTotal.Visible(True)
		Gui.FrmSOMain.lblPastDueTotal.Visible(False)
		Gui.FrmSOMain.txtPastDueTotal.Visible(False)
		Gui.FrmSOMain.txtChartTotal.Visible(False)
		Gui.FrmSOMain.lblPercent1.Visible(False)
		Gui.FrmSOMain.lblPercent2.Visible(False)
		Gui.FrmSOMain.txtPercent.Visible(False)
		Gui.FrmSOMain.cmdExport.Enabled(True)
	F.Intrinsic.Control.ElseIf(V.Screen.FrmSOMain!tabSODash.Tab,=,1)
		Gui.FrmSOMain.lblAllTotal.Visible(False)
		Gui.FrmSOMain.txtAllTotal.Visible(False)
		Gui.FrmSOMain.lblPastDueTotal.Visible(True)
		Gui.FrmSOMain.txtPastDueTotal.Visible(True)
		Gui.FrmSOMain.txtChartTotal.Visible(False)
		Gui.FrmSOMain.lblPercent1.Visible(False)
		Gui.FrmSOMain.lblPercent2.Visible(False)
		Gui.FrmSOMain.txtPercent.Visible(False)
		Gui.FrmSOMain.cmdExport.Enabled(True)
	F.Intrinsic.Control.ElseIf(V.Screen.FrmSOMain!tabSODash.Tab,=,2)
		Gui.FrmSOMain.lblAllTotal.Visible(True)
		Gui.FrmSOMain.txtAllTotal.Visible(False)
		Gui.FrmSOMain.lblPastDueTotal.Visible(False)
		Gui.FrmSOMain.txtPastDueTotal.Visible(False)
		Gui.FrmSOMain.txtChartTotal.Visible(True)
		Gui.FrmSOMain.lblPercent1.Visible(True)
		Gui.FrmSOMain.lblPercent2.Visible(True)
		Gui.FrmSOMain.txtPercent.Visible(True)
		Gui.FrmSOMain.cmdExport.Enabled(False)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.tabSODash_Click.End

Program.Sub.CheckNote.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.sSO.Declare
	V.Local.sLine.Declare
	V.Local.iRows.Declare
	V.Local.iCnt.Declare

	F.Intrinsic.Control.If(V.Args.SO_Note,=,"NOTES")
		Gui.FrmSOMain.GsGCDueSO.GetRowCount("gvDueSO",V.Local.iRows)
		F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
			Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","Order_NO",V.Local.iCnt,V.Local.sSO)
			Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","Record_NO",V.Local.iCnt,V.Local.sLine)
			F.Intrinsic.Control.If(V.Local.sSO,=,V.Args.SO)
			F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
				Gui.FrmSOMain.GsGCDueSO.SetCellValueByColumnName("gvDueSO","NOTES",V.Local.iCnt,V.Args.Note)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.iCnt)
		Gui.FrmSOMain.GsGCAllSO.GetRowCount("gvAllSO",V.Local.iRows)
		F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
			Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","Order_NO",V.Local.iCnt,V.Local.sSO)
			Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","Record_NO",V.Local.iCnt,V.Local.sLine)
			F.Intrinsic.Control.If(V.Local.sSO,=,V.Args.SO)
			F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
				Gui.FrmSOMain.GsGCAllSO.SetCellValueByColumnName("gvAllSO","NOTES",V.Local.iCnt,V.Args.Note)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.iCnt)

	F.Intrinsic.Control.ElseIf(V.Args.SO_Note,=,"USER_4")
		Gui.FrmSOMain.GsGCDueSO.GetRowCount("gvDueSO",V.Local.iRows)
		F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
			Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","Order_NO",V.Local.iCnt,V.Local.sSO)
			Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","Record_NO",V.Local.iCnt,V.Local.sLine)
			F.Intrinsic.Control.If(V.Local.sSO,=,V.Args.SO)
			F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
				Gui.FrmSOMain.GsGCDueSO.SetCellValueByColumnName("gvDueSO","USER_4",V.Local.iCnt,V.Args.Note)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.iCnt)
		Gui.FrmSOMain.GsGCAllSO.GetRowCount("gvAllSO",V.Local.iRows)
		F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
			Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","Order_NO",V.Local.iCnt,V.Local.sSO)
			Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","Record_NO",V.Local.iCnt,V.Local.sLine)
			F.Intrinsic.Control.If(V.Local.sSO,=,V.Args.SO)
			F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
				Gui.FrmSOMain.GsGCAllSO.SetCellValueByColumnName("gvAllSO","USER_4",V.Local.iCnt,V.Args.Note)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.iCnt)

	F.Intrinsic.Control.ElseIf(V.Args.SO_Note,=,"USER_5")
		Gui.FrmSOMain.GsGCDueSO.GetRowCount("gvDueSO",V.Local.iRows)
		F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
			Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","Order_NO",V.Local.iCnt,V.Local.sSO)
			Gui.FrmSOMain.GsGCDueSO.GetCellValueByColumnName("gvDueSO","Record_NO",V.Local.iCnt,V.Local.sLine)
			F.Intrinsic.Control.If(V.Local.sSO,=,V.Args.SO)
			F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
				Gui.FrmSOMain.GsGCDueSO.SetCellValueByColumnName("gvDueSO","USER_5",V.Local.iCnt,V.Args.Note)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.iCnt)
		Gui.FrmSOMain.GsGCAllSO.GetRowCount("gvAllSO",V.Local.iRows)
		F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
			Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","Order_NO",V.Local.iCnt,V.Local.sSO)
			Gui.FrmSOMain.GsGCAllSO.GetCellValueByColumnName("gvAllSO","Record_NO",V.Local.iCnt,V.Local.sLine)
			F.Intrinsic.Control.If(V.Local.sSO,=,V.Args.SO)
			F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
				Gui.FrmSOMain.GsGCAllSO.SetCellValueByColumnName("gvAllSO","USER_5",V.Local.iCnt,V.Args.Note)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.iCnt)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.CheckNote.End

Program.Sub.CheckTable.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.bExists.Declare
	
	F.ODBC.Connection!con.TableExists("GAB_4595_NOTES",V.Local.bExists)
	F.Intrinsic.Control.If(V.Local.bExists,=,False)
		f.ODBC.Connection!con.Execute("CREATE TABLE GAB_4595_NOTES(NID IDENTITY,ORDER_NO CHAR(7),ORDER_LINE CHAR(4),GSUSER CHAR(8),CREATE_DT DATE,CREATE_TIME TIME,NOTES LONGVARCHAR,PRIMARY KEY(NID));")
		F.ODBC.Connection!con.Execute("CREATE INDEX GAB_4595_NOTES01 USING 1 ON GAB_4595_NOTES(ORDER_NO);")
		F.ODBC.Connection!con.Execute("CREATE INDEX GAB_4595_NOTES02 USING 2 ON GAB_4595_NOTES(ORDER_LINE);")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.CheckTable.End

Program.Sub.cmdExport_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.sFileExport.Declare
	V.Local.bExcel.Declare
	V.Local.bFileLocked.Declare
	V.Local.sMsg.Declare

	F.Automation.MSExcel.CheckPresence(V.Local.bExcel)

	F.Intrinsic.Control.SelectCase(V.Screen.FrmSOMain!tabSODash.Tab)
		F.Intrinsic.Control.Case(0)
			F.Intrinsic.Control.If(V.Local.bExcel)
				F.Intrinsic.String.Build("{0}\GAB_4595_AllSOs_Export.xlsx",V.Caller.LocalGssTempDir,V.Local.sFileExport)
				F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
				F.Intrinsic.Control.If(V.Local.bFileLocked)
					F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
					F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
				F.Intrinsic.Control.Else
					Gui.FrmSOMain.GsGCAllSO.Export(V.Local.sFileExport,"xlsx")
					F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("{0}\GAB_4595_AllSOs_Export.csv",V.Caller.LocalGssTempDir,V.Local.sFileExport)
				F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
				F.Intrinsic.Control.If(V.Local.bFileLocked)
					F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
					F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
				F.Intrinsic.Control.Else
					Gui.FrmSOMain.GsGCAllSO.Export(V.Local.sFileExport,"csv")
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case(1)
			F.Intrinsic.Control.If(V.Local.bExcel)
				F.Intrinsic.String.Build("{0}\GAB_4595_PastDue_Export.xlsx",V.Caller.LocalGssTempDir,V.Local.sFileExport)
				F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
				F.Intrinsic.Control.If(V.Local.bFileLocked)
					F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
					F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
				F.Intrinsic.Control.Else
					Gui.FrmSOMain.GsGCDueSO.Export(V.Local.sFileExport,"xlsx")
					F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("{0}\GAB_4595_PastDue_Export.csv",V.Caller.LocalGssTempDir,V.Local.sFileExport)
				F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
				F.Intrinsic.Control.If(V.Local.bFileLocked)
					F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
					F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
				F.Intrinsic.Control.Else
					Gui.FrmSOMain.GsGCDueSO.Export(V.Local.sFileExport,"csv")
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
			F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.cmdExport_Click.End

Program.Sub.picGSSLogo_DblClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	Gui.frmWeb..Show
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.picGSSLogo_DblClick.End

Program.Sub.frmWeb_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	Gui.frmWeb..Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.frmWeb_UnLoad.End

Program.Sub.cmdGSS_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	F.Intrinsic.Task.ShellExec(0,"Open","http://www.globalshopsolutions.com/","","",0)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.cmdGSS_Click.End

Program.Sub.cmdServ_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	F.Intrinsic.Task.ShellExec(0,"Open","http://gss-service.com/","","",0)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.cmdServ_Click.End

Program.Sub.cmdUpd_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	F.Intrinsic.Task.ShellExec(0,"Open","http://gss-updates.com/","","",0)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.cmdUpd_Click.End

Program.Sub.cmdResetGsGC_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.ODBC.Connection!common.OpenConnection(V.Ambient.Ccon,V.Ambient.Cuser,V.Ambient.Cpass)
	F.ODBC.Connection!common.Execute("Delete From Gs_Registry Where Reg_ID = 4595 And Seq = 1000;")
	F.ODBC.Connection!common.Close
	
	Gui.frmWeb..Visible(False)
	V.Global.bLoadData.Set(False)
	F.Intrinsic.Control.CallSub(frmweb_unload)
	F.Intrinsic.Control.CallSub(cmdReFresh_Click)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.cmdResetGsGC_Click.End

Program.Sub.Serialize.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSerialize.Declare
	
	'GVAllSO
	Gui.FrmSOMain.GsGCAllSO.Serialize("gvAllSO",V.Local.sSerialize)
	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVALLSO",4595,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	'GVDueSO
	Gui.FrmSOMain.GsGCDueSO.Serialize("GVDueSO",V.Local.sSerialize)
	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVDUESO",4595,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.Serialize.End

Program.Sub.Deserialize.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSerialize.Declare
	V.Local.bFile.Declare
	
	'Delete old registry records
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVALLSO",4595,0,5,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize,<>,"")
		F.ODBC.Connection!common.OpenConnection(V.Ambient.Ccon,V.Ambient.Cuser,V.Ambient.Cpass)
		F.ODBC.Connection!common.Execute("Delete From Gs_Registry Where Reg_ID = 4595 And Seq < 1000;")
		F.ODBC.Connection!common.Close
	F.Intrinsic.Control.EndIf

	'GVAllSO
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVALLSO",4595,1000,6,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize,<>,"")
		Gui.FrmSOMain.GsGCAllSO.Deserialize(V.Local.sSerialize)
	F.Intrinsic.Control.EndIf
	'GVDueSO
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVDUESO",4595,1000,6,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize,<>,"")
		Gui.FrmSOMain.GsGCDueSO.Deserialize(V.Local.sSerialize)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.Deserialize.End

Program.Sub.SetContextMenus.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmNotes..ContextMenuCreate("ctxNotes")
	Gui.frmNotes.GsGCNotes.ContextMenuAttach("ctxNotes")
	Gui.frmNotes..ContextMenuAddItem("ctxNotes","AddNote",0,"Add Note")
	Gui.frmNotes..ContextMenuSetItemEventHandler("ctxNotes","AddNote","MenuClickAdd")
	Gui.frmNotes..ContextMenuAddItem("ctxNotes","DelNote",0,"Delete Note")
	Gui.frmNotes..ContextMenuSetItemEventHandler("ctxNotes","DelNote","MenuClickDelete")
	Gui.frmNotes..ContextMenuAddItem("ctxNotes","Refresh",0,"Refresh")
	Gui.frmNotes..ContextMenuSetItemEventHandler("ctxNotes","Refresh","MenuClickRefresh")
	Gui.frmNotes..ContextMenuAddItem("ctxNotes","Export",0,"Export")
	Gui.frmNotes..ContextMenuSetItemEventHandler("ctxNotes","Export","MenuClickExport")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.SetContextMenus.End

Program.Sub.MenuClickAdd.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iNID.Declare
	V.Local.sTest.Declare
	
	F.ODBC.Connection!con.ExecuteAndReturn("Select Max(NID) From Gab_4595_Notes;",V.Local.iNID)
	F.Intrinsic.Math.Add(V.Local.iNID,1,V.Local.iNID)
	F.Data.DataTable.AddRow("dtNotes","NID",V.Local.iNID,"ORDER_NO",V.Global.sOrderNo,"ORDER_LINE",V.Global.sOrderLn,"GSUSER",V.Caller.User,"CREATE_DT",V.Ambient.Date,"CREATE_TIME",V.Ambient.Time.FormatHh:Nn:Ss)
	F.Data.DataTable.RemoveColumn("dtNotes","Email")
	F.Data.DataTable.RemoveColumn("dtNotes","Text")
	F.Data.DataTable.SaveToDB("dtNotes","con","GAB_4595_NOTES","NID")
	F.Intrinsic.Control.CallSub(LoadDtNotes)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickAdd.End

Program.Sub.MenuClickDelete.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRow.Declare
	V.Local.sSQL.Declare
	
	Gui.frmNotes.GsGCNotes.GetSelectedRows("gvNotes",V.Local.iRow)
	F.Intrinsic.String.Build("Delete From Gab_4595_Notes Where NID = {0};",V.DataTable.dtNotes(V.Local.iRow).NID!FieldVal,V.Local.sSQL)
	F.ODBC.Connection!con.Execute(V.Local.sSQL)
	F.Data.DataTable.DeleteRow("dtNotes",V.Local.iRow)
	F.Intrinsic.Control.CallSub(LoadDtNotes)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: GAB_4571_Security_Setup.g2u{0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}.",V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickDelete.End

Program.Sub.MenuClickRefresh.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.CallSub(LoadDtNotes)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickRefresh.End

Program.Sub.MenuClickExport.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sFileExport.Declare
	V.Local.bExcel.Declare
	V.Local.bFileLocked.Declare
	V.Local.sMsg.Declare
	V.Local.iRet.Declare

	F.Automation.MSExcel.CheckPresence(V.Local.bExcel)
	F.Intrinsic.Control.If(V.Local.bExcel)
		F.Intrinsic.String.Build("{0}\GAB_4595_Ship_Export.xlsx",V.Caller.LocalGssTempDir,V.Local.sFileExport)
		F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
		F.Intrinsic.Control.If(V.Local.bFileLocked)
			F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
			F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
		F.Intrinsic.Control.Else
			Gui.frmNotes.GsGCNotes.Export(V.Local.sFileExport,"xlsx")
			F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0}\GAB_4595_Ship_Export.csv",V.Caller.LocalGssTempDir,V.Local.sFileExport)
		F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
		F.Intrinsic.Control.If(V.Local.bFileLocked)
			F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
			F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
		F.Intrinsic.Control.Else
			Gui.frmNotes.GsGCNotes.Export(V.Local.sFileExport,"csv")
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickExport.End

Program.Sub.LoadDtNotes.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare

	F.Intrinsic.Control.If(V.DataTable.dtNotes.Exists)
		F.Data.DataTable.Close("dtNotes")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.String.Build("Select * From GAB_4595_NOTES Where Order_No = '{0}' And Order_Line = '{1}' Order By Create_Dt Desc, Create_Time Desc;",V.Global.sOrderNo,V.Global.sOrderLn,V.Local.sSQL)
	F.Data.DataTable.CreateFromSQL("dtNotes","con",V.Local.sSQL,True)
	F.Data.DataTable.AddColumn("dtNotes","Email",String,"Email")
	F.Data.DataTable.AddColumn("dtNotes","Text",String,"Text Msg")
	F.Intrinsic.Control.CallSub(LoadGvNotes)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDtNotes.End

Program.Sub.LoadGvNotes.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmNotes.GsGCNotes.AddGridViewFromDataTable("gvNotes","dtNotes")
	Gui.frmNotes.GsGCNotes.MainView("gvNotes")
	Gui.frmNotes.GsGCNotes.SuspendLayout()
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvNotes","MultiSelect",True)
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvNotes","OptionBehaviorEditable",True)
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvNotes","AllowSort",True)
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvNotes","AllowFilter",True)
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvNotes","OptionsDetailShowDetailTabs",False)
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvNotes","OptionsViewShowGroupPanel",True)
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvNotes","EnableAppearanceOddRow",True)
	
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NID","Visible",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","ORDER_NO","Visible",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","ORDER_LINE","Visible",False)
	
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","Email","ShowCaption",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","Text","ShowCaption",False)

	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","ORDER_NO","Caption","Order")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","ORDER_LINE","Caption","Line")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","GSUSER","Caption","User")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","CREATE_DT","Caption","Create Date")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","CREATE_TIME","Caption","Create Time")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NOTES","Caption","Notes")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","Email","Caption","Email")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","Text","Caption","Text Msg")
	
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","ORDER_NO","AllowEdit",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","ORDER_LINE","AllowEdit",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","GSUSER","AllowEdit",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","CREATE_DT","AllowEdit",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","CREATE_TIME","AllowEdit",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NOTES","AllowEdit",True)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","Email","AllowEdit",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","Text","AllowEdit",False)
	
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NOTES","ReadOnly",False)

	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","ORDER_NO","MinWidth","50")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","ORDER_LINE","MinWidth","50")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","GSUSER","MinWidth","50")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","CREATE_DT","MinWidth","50")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","CREATE_TIME","MinWidth","50")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NOTES","MinWidth","350")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","Email","MinWidth","20")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","Text","MinWidth","20")
	
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","ORDER_NO","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","ORDER_LINE","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","GSUSER","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","CREATE_DT","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","CREATE_TIME","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NOTES","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","Email","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","Text","HeaderHAlignment","Center")
	
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","ORDER_NO","CellHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","ORDER_LINE","CellHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","GSUSER","CellHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","CREATE_DT","CellHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","CREATE_TIME","CellHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","Email","CellHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","Text","CellHAlignment","Center")
	
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","NOTES","CellBackColor","LightYellow")
	
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","Email","CellBackColor","Gray")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","Text","CellBackColor","Gray")
	
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","Email","CellForeColor","White")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","Text","CellForeColor","White")
	
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvNotes","CREATE_DT","DisplayCustomDatetime","d")
	
	Gui.frmNotes.GsGCNotes.ResumeLayout()

	Gui.frmNotes..Visible(True)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadGvNotes.End

Program.Sub.frmNotes_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmNotes..Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.frmNotes_UnLoad.End

Program.Sub.GsGCNotes_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sOrder.Declare
	V.Local.sLine.Declare
	V.Local.sUser.Declare
	V.Local.dCreateDt.Declare
	V.Local.sCreateTime.Declare
	V.Local.sNotes.Declare
	V.Local.sSubject.Declare
	V.Local.sBody.Declare
	
	Gui.frmNotes.GsGCNotes.GetCellValueByColumnName("gvNotes","ORDER_NO",V.Args.RowIndex,V.Local.sOrder)
	Gui.frmNotes.GsGCNotes.GetCellValueByColumnName("gvNotes","ORDER_LINE",V.Args.RowIndex,V.Local.sLine)
	Gui.frmNotes.GsGCNotes.GetCellValueByColumnName("gvNotes","GSUSER",V.Args.RowIndex,V.Local.sUser)
	Gui.frmNotes.GsGCNotes.GetCellValueByColumnName("gvNotes","CREATE_DT",V.Args.RowIndex,V.Local.dCreateDt)
	Gui.frmNotes.GsGCNotes.GetCellValueByColumnName("gvNotes","CREATE_TIME",V.Args.RowIndex,V.Local.sCreateTime)
	Gui.frmNotes.GsGCNotes.GetCellValueByColumnName("gvNotes","NOTES",V.Args.RowIndex,V.Local.sNotes)
	
	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.Case("Email")
			F.Intrinsic.String.Build("Notes for Sales Order ({0}-{1})",V.Local.sOrder,V.Local.sLine,V.Local.sSubject)
			F.Intrinsic.String.Build("Hello,{0}{1} entered in,{2}{3}{2}, on {4} at {5}.{0}{0}Customer: {6}{0}Salesperson: {7}{0}Part Number: {8}{0}Part Description: {9}{0}Quantity: {10}{0}Customer PO: {11}{0}Ship Date: {12}",V.Ambient.NewLine,V.Local.sUser,V.Ambient.DblQuote,V.Local.sNotes,V.Local.dCreateDt,V.Local.sCreateTime,V.Global.sCustomer.Trim,V.Global.sSalesperson.Trim,V.Global.sPart.Trim,V.Global.sPaerDesc.Trim,V.Global.fQty,V.Global.sCustPO,V.Global.dDueDate,V.Local.sBody)
			Gui.frmEmail.txtRcpts.Text("")
			Gui.frmEmail.txtSubject.Text(V.Local.sSubject)
			Gui.frmEmail.txtBody.Text(V.Local.sBody)
			Gui.frmText..Visible(False)
			Gui.frmEmail..Show
		F.Intrinsic.Control.Case("Text")
			F.Intrinsic.String.Build("Notes for Sales Order ({0}-{1})",V.Local.sOrder,V.Local.sLine,V.Local.sSubject)
			F.Intrinsic.String.Build("Hello,{0}{1} entered in,{2}{3}{2}, on {4} at {5}.{0}{0}Customer: {6}{0}Salesperson: {7}{0}Part Number: {8}{0}Part Description: {9}{0}Quantity: {10}{0}Customer PO: {11}{0}Ship Date: {12}",V.Ambient.NewLine,V.Local.sUser,V.Ambient.DblQuote,V.Local.sNotes,V.Local.dCreateDt,V.Local.sCreateTime,V.Global.sCustomer.Trim,V.Global.sSalesperson.Trim,V.Global.sPart.Trim,V.Global.sPaerDesc.Trim,V.Global.fQty,V.Global.sCustPO,V.Global.dDueDate,V.Local.sBody)
			Gui.frmText.txtRcpts.Text("")
			Gui.frmText.txtSubject.Text(V.Local.sSubject)
			Gui.frmText.txtBody.Text(V.Local.sBody)
			Gui.frmEmail..Visible(False)
			Gui.frmText..Show
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCNotes_RowCellClick.End

Program.Sub.GsGCNotes_CellValueChanged.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sText.Declare
	V.Local.sSQL.Declare
	
	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.Case("NOTES")
			F.Intrinsic.String.Replace(V.Args.Value,"'","''",V.Local.sText)
			F.Intrinsic.String.Build("Update Gab_4595_Notes Set Notes = '{0}' Where NID = {1};",V.Local.sText,V.DataTable.dtNotes(V.Args.RowIndex).NID!FieldVal,V.Local.sSQL)
			F.ODBC.Connection!con.Execute(V.Local.sSQL)
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCNotes_CellValueChanged.End

Program.Sub.cmdSend_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRet.Declare
	V.Local.iCnt.Declare
	V.Local.sEmails.Declare
	V.Local.iUserID.Declare
	V.Local.sSender.Declare
	V.Local.sRcpts.Declare
	
	F.Global.Security.GetUserId(V.Caller.User,V.Caller.CompanyCode,V.Local.iUserID)
	F.Intrinsic.String.Build("{0}*!*{0}",V.Global.sUserEmail,V.Local.sSender)
	
	F.Intrinsic.Control.If(V.Global.sUserEmail,<>,"")
		F.Intrinsic.UI.Msgbox("Do you want to continue and send an email to all the entered recipients?","Email",4,V.Local.iRet)
		F.Intrinsic.Control.If(V.Local.iRet,=,6)

			F.Intrinsic.Control.CallSub(CheckCourier)
			F.Intrinsic.String.Split(V.Screen.frmEmail!txtRcpts.Text,",",V.Local.sEmails)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sEmails.UBound,1)
				F.Intrinsic.Control.If(V.Local.iCnt,=,0)
					F.Intrinsic.String.Build("{0}*!*{0}",V.Local.sEmails(V.Local.iCnt),V.Local.sRcpts)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("{0}@!@{1}*!*{1}",V.Local.sRcpts,V.Local.sEmails(V.Local.iCnt),V.Local.sRcpts)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
			F.Global.Messaging.QueueMessage(V.Caller.CompanyCode,V.Local.iUserID,"",V.Screen.frmEmail!txtSubject.Text,V.Local.sSender,V.Local.sRcpts,V.Screen.frmEmail!txtBody.Text)
			Gui.frmEmail..Visible(False)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		F.Intrinsic.UI.Msgbox("No Email set up for user.","No Email Setup")
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdSend_Click.End

Program.Sub.frmEmail_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmEmail..Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.frmEmail_UnLoad.End

Program.Sub.cmdSendText_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRet.Declare
	V.Local.iCarrier.Declare
	V.Local.sNumbers.Declare
	V.Local.sNumbersSend.Declare
	V.Local.iLen.Declare
	V.Local.iCnt.Declare
	
	F.Intrinsic.Control.If(V.Global.sUserEmail,<>,"")
		F.Intrinsic.UI.Msgbox("Do you want to continue and send a text message to all the entered recipients?","Text Message",4,V.Local.iRet)
		F.Intrinsic.Control.If(V.Local.iRet,=,6)
			F.Intrinsic.Control.CallSub(CheckCourier)
			F.Intrinsic.Control.SelectCase(V.Screen.frmText!ddl1.Text)
				F.Intrinsic.Control.Case("ATT")
					V.Local.iCarrier.Set(0)
				F.Intrinsic.Control.Case("T-Mobile")
					V.Local.iCarrier.Set(1)
				F.Intrinsic.Control.Case("Sprint")
					V.Local.iCarrier.Set(3)
				F.Intrinsic.Control.Case("Verizon")
					V.Local.iCarrier.Set(4)
				F.Intrinsic.Control.CaseElse
					V.Local.iCarrier.Set(-1)
			F.Intrinsic.Control.EndSelect
			F.Intrinsic.Control.If(V.Local.iCarrier,<>,-1)
				F.Intrinsic.String.Split(V.Screen.frmText!txtRcpts.Text,",",V.Local.sNumbers)
				F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sNumbers.UBound,1)
					F.Intrinsic.String.Replace(V.Local.sNumbers(V.Local.iCnt),"-","",V.Local.sNumbersSend)
					F.Intrinsic.String.Len(V.Local.sNumbersSend,V.Local.iLen)
					F.Intrinsic.Control.If(V.Local.iLen,=,10)
						F.Global.Messaging.CreateSMSmessage(V.Local.iCarrier,V.Local.sNumbersSend,V.Global.sUserEmail,V.Screen.frmText!txtSubject.Text,V.Screen.frmText!txtBody.Text)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Next(V.Local.iCnt)
				Gui.frmText..Visible(False)
			F.Intrinsic.Control.Else
				F.Intrinsic.UI.Msgbox("Select a carrier.","Carrier Missing")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		F.Intrinsic.UI.Msgbox("No Email set up for user.","No Email Setup")
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdSendText_Click.End

Program.Sub.frmText_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmText..Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.frmText_UnLoad.End

Program.Sub.SetCarriers.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	V.Local.sCarriers.Declare
	
	V.Local.sCarriers.Set("ATT*!*T-Mobile*!*Sprint*!*Verizon")
	F.Intrinsic.String.Split(V.Local.sCarriers,"*!*",V.Local.sCarriers)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sCarriers.UBound,1)
		Gui.frmText.ddl1.AddItem(V.Local.sCarriers(V.Local.iCnt),V.Local.iCnt)
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.SetCarriers.End

Program.Sub.CheckCourier.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.bCourier.Declare
	
	F.Global.Messaging.IsCourierRunning(V.Local.bCourier)
	F.Intrinsic.Control.If(V.Local.bCourier,=,False)
		F.Intrinsic.UI.Msgbox("Messages will not be sent until Courier is on","Courier is Not Running")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckCourier.End